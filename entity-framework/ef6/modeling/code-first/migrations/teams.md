---
title: Code First-Migrationen in Teamumgebungen - EF6
author: divega
ms.date: 2016-10-23
ms.assetid: 4c2d9a95-de6f-4e97-9738-c1f8043eff69
ms.openlocfilehash: 31f8476c64d36d4d1cf3d18deb59ebc482dcc975
ms.sourcegitcommit: 0d36e8ff0892b7f034b765b15e041f375f88579a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/09/2018
ms.locfileid: "44251231"
---
# <a name="code-first-migrations-in-team-environments"></a><span data-ttu-id="e217f-102">Code First-Migrationen in Teamumgebungen</span><span class="sxs-lookup"><span data-stu-id="e217f-102">Code First Migrations in Team Environments</span></span>
> [!NOTE]
> <span data-ttu-id="e217f-103">In diesem Artikel wird davon ausgegangen, dass Sie wissen, wie Code First-Migrationen in grundlegenden Szenarien verwenden.</span><span class="sxs-lookup"><span data-stu-id="e217f-103">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="e217f-104">Wenn Sie dies nicht tun, müssen Sie lesen [Code First-Migrationen](~/ef6/modeling/code-first/migrations/index.md) vor dem fortfahren.</span><span class="sxs-lookup"><span data-stu-id="e217f-104">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="grab-a-coffee-you-need-to-read-this-whole-article"></a><span data-ttu-id="e217f-105">Einen Kaffee, müssen Sie diesen gesamten Artikel lesen</span><span class="sxs-lookup"><span data-stu-id="e217f-105">Grab a coffee, you need to read this whole article</span></span>

<span data-ttu-id="e217f-106">Die Probleme in teamumgebungen sind hauptsächlich, um das Zusammenführen von Migrationen, bei der zwei Entwickler Migrationen in ihrer lokalen Codebasis generiert haben.</span><span class="sxs-lookup"><span data-stu-id="e217f-106">The issues in team environments are mostly around merging migrations when two developers have generated migrations in their local code base.</span></span> <span data-ttu-id="e217f-107">Während Sie die Schritte mit der diese ziemlich einfach sind, erforderlich sind Sie solide Kenntnisse über die Funktionsweise von Migrationen.</span><span class="sxs-lookup"><span data-stu-id="e217f-107">While the steps to solve these are pretty simple, they require you to have a solid understanding of how migrations works.</span></span> <span data-ttu-id="e217f-108">Sie nicht nur fahren Sie mit der End-finden Sie im gesamten Artikel, um sicherzustellen, dass Sie erfolgreich sind die Zeit in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="e217f-108">Please don’t just skip ahead to the end – take the time to read the whole article to ensure you are successful.</span></span>

## <a name="some-general-guidelines"></a><span data-ttu-id="e217f-109">Einige allgemeinen Richtlinien</span><span class="sxs-lookup"><span data-stu-id="e217f-109">Some general guidelines</span></span>

<span data-ttu-id="e217f-110">Bevor wir näher so verwalten Sie das Zusammenführen von Migrationen, die von mehreren Entwicklern generiert untersuchen, sind hier einige allgemeinen Richtlinien, die Sie festlegen, Erfolge.</span><span class="sxs-lookup"><span data-stu-id="e217f-110">Before we dig into how to manage merging migrations generated by multiple developers, here are some general guidelines to set you up for success.</span></span>

### <a name="each-team-member-should-have-a-local-development-database"></a><span data-ttu-id="e217f-111">Jedes Teammitglied sollte eine lokale Entwicklungs-Datenbank verfügen.</span><span class="sxs-lookup"><span data-stu-id="e217f-111">Each team member should have a local development database</span></span>

<span data-ttu-id="e217f-112">Migrationen verwendet die  **\_ \_MigrationsHistory** Tabelle zum Speichern, welche Migrationen auf die Datenbank angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="e217f-112">Migrations uses the **\_\_MigrationsHistory** table to store what migrations have been applied to the database.</span></span> <span data-ttu-id="e217f-113">Wenn mehrere generieren Weitere Migrationen beim Versuch Entwickler, die an dieselbe Datenbank gerichtet (und somit eine  **\_ \_MigrationsHistory** Tabelle) Migrationen sehr verwirrt werden soll.</span><span class="sxs-lookup"><span data-stu-id="e217f-113">If you have multiple developers generating different migrations while trying to target the same database (and thus share a **\_\_MigrationsHistory** table) migrations is going to get very confused.</span></span>

<span data-ttu-id="e217f-114">Wenn Sie Teammitglieder, die Migrationen zu generieren haben, werden nicht, besteht natürlich kein Problem, müssen sie eine zentrale Development-Datenbank gemeinsam nutzen.</span><span class="sxs-lookup"><span data-stu-id="e217f-114">Of course, if you have team members that aren’t generating migrations, there is no problem having them share a central development database.</span></span>

### <a name="avoid-automatic-migrations"></a><span data-ttu-id="e217f-115">Vermeiden Sie automatische Migrationen</span><span class="sxs-lookup"><span data-stu-id="e217f-115">Avoid automatic migrations</span></span>

<span data-ttu-id="e217f-116">Das Fazit ist, dass automatische Migrationen anfänglich in teamumgebungen gut aussehen, aber in Wirklichkeit nur funktionieren nicht.</span><span class="sxs-lookup"><span data-stu-id="e217f-116">The bottom line is that automatic migrations initially look good in team environments, but in reality they just don’t work.</span></span> <span data-ttu-id="e217f-117">Wenn Sie wissen, warum, lesen – beibehalten möchten, dann können Sie mit dem nächsten Abschnitt fortfahren.</span><span class="sxs-lookup"><span data-stu-id="e217f-117">If you want to know why, keep reading – if not, then you can skip to the next section.</span></span>

<span data-ttu-id="e217f-118">Automatische Migrationen können Sie das Datenbankschema aktualisiert, um das aktuelle Modell ohne die Notwendigkeit zum Generieren von Codedateien (Code-basierte Migrationen) übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="e217f-118">Automatic migrations allows you to have your database schema updated to match the current model without the need to generate code files (code-based migrations).</span></span> <span data-ttu-id="e217f-119">Automatische Migrationen funktioniert sehr gut in einer teamumgebung, wenn Sie nur einmal verwendet und nie Code-basierte Migrationen generiert.</span><span class="sxs-lookup"><span data-stu-id="e217f-119">Automatic migrations would work very well in a team environment if you only ever used them and never generated any code-based migrations.</span></span> <span data-ttu-id="e217f-120">Das Problem besteht darin, dass automatische Migrationen sind beschränkt und nicht behandeln eine Reihe von Operationen Eigenschaftenspalte/benennt, Verschieben von Daten in einer anderen Tabelle usw. Für solche Szenarien entworfen, erhalten Sie letztlich, Generieren von Code-basierte Migrationen (und Bearbeiten des eingerüsteten Codes), die zwischen den Änderungen gemischt werden, die durch automatische Migrationen behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="e217f-120">The problem is that automatic migrations are limited and don’t handle a number of operations – property/column renames, moving data to another table, etc. To handle these scenarios you end up generating code-based migrations (and editing the scaffolded code) that are mixed in between changes that are handled by automatic migrations.</span></span> <span data-ttu-id="e217f-121">Dadurch wird es in der Nähe auf unmöglich, Änderungen zu mergen, wenn zwei Entwickler bei Migrationen aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e217f-121">This makes it near on impossible to merge changes when two developers check in migrations.</span></span>

## <a name="screencasts"></a><span data-ttu-id="e217f-122">Screencasts</span><span class="sxs-lookup"><span data-stu-id="e217f-122">Screencasts</span></span>

<span data-ttu-id="e217f-123">Wenn Sie stattdessen sehen Sie sich einen Screencast als diesen Artikel lesen würde, behandelt die beiden folgenden Videos den gleichen Inhalt wie in diesem Artikel.</span><span class="sxs-lookup"><span data-stu-id="e217f-123">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="e217f-124">Video 1: "Migrations - im Hintergrund"</span><span class="sxs-lookup"><span data-stu-id="e217f-124">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="e217f-125">[Dieser Screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) befasst sich mit Migrationen wie nachverfolgt und Informationen über das Modell zum Erkennen von Änderungen des Datenmodells verwendet.</span><span class="sxs-lookup"><span data-stu-id="e217f-125">[This screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---team-environments"></a><span data-ttu-id="e217f-126">Video 2: "Migrations - Teamumgebungen"</span><span class="sxs-lookup"><span data-stu-id="e217f-126">Video Two: "Migrations - Team Environments"</span></span>

<span data-ttu-id="e217f-127">Erstellen auf den Konzepten von der früheren Video behandelt, [diesem Screencast](http://channel9.msdn.com/blogs/ef/migrations-team-environments) behandelt die Probleme, die in einer teamumgebung und zu deren Lösung auftreten.</span><span class="sxs-lookup"><span data-stu-id="e217f-127">Building on the concepts from the previous video, [this screencast](http://channel9.msdn.com/blogs/ef/migrations-team-environments) covers the issues that arise in a team environment and how to solve them.</span></span>

## <a name="understanding-how-migrations-works"></a><span data-ttu-id="e217f-128">Grundlegendes zur Funktionsweise von Migrationen</span><span class="sxs-lookup"><span data-stu-id="e217f-128">Understanding how migrations works</span></span>

<span data-ttu-id="e217f-129">Der Schlüssel beim Verwenden von Migrationen erfolgreich in einer teamumgebung stellt ein grundlegendes Verständnis, wie Migrationen nachverfolgt und Informationen über das Modell zum Erkennen von Änderungen des Datenmodells verwendet.</span><span class="sxs-lookup"><span data-stu-id="e217f-129">The key to successfully using migrations in a team environment is a basic understanding how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="the-first-migration"></a><span data-ttu-id="e217f-130">Die erste migration</span><span class="sxs-lookup"><span data-stu-id="e217f-130">The first migration</span></span>

<span data-ttu-id="e217f-131">Wenn Sie die erste Migration zu Ihrem Projekt hinzufügen, führen Sie etwa **Add-Migration erste** in Paket-Manager-Konsole.</span><span class="sxs-lookup"><span data-stu-id="e217f-131">When you add the first migration to your project, you run something like **Add-Migration First** in Package Manager Console.</span></span> <span data-ttu-id="e217f-132">Die allgemeinen Schritte, die mit diesem Befehl wird, sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="e217f-132">The high level steps that this command performs are pictured below.</span></span>

![Erste Migration](~/ef6/media/firstmigration.png)

<span data-ttu-id="e217f-134">Das aktuelle Modell wird im Code (1) berechnet.</span><span class="sxs-lookup"><span data-stu-id="e217f-134">The current model is calculated from your code (1).</span></span> <span data-ttu-id="e217f-135">Die erforderlichen Datenbankobjekte werden dann berechnet, indem das Modell unterscheiden (2) – da dies die erste Migration des Modells ist, unterscheiden sich lediglich verwendet ein leeres Modell für den Vergleich.</span><span class="sxs-lookup"><span data-stu-id="e217f-135">The required database objects are then calculated by the model differ (2) – since this is the first migration the model differ just uses an empty model for the comparison.</span></span> <span data-ttu-id="e217f-136">Die erforderlichen Änderungen werden übergeben, um den Code-Generator, um den Code für eine Migration erforderlich (3) erstellen, die Visual Studio-Projektmappe (4) klicken Sie dann hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="e217f-136">The required changes are passed to the code generator to build the required migration code (3) which is then added to your Visual Studio solution (4).</span></span>

<span data-ttu-id="e217f-137">Migrationen zusätzlich zu die eigentliche Migration-Code, der in der Haupt-Codedatei gespeichert wird, auch einige zusätzliche Code-Behind-Dateien generiert.</span><span class="sxs-lookup"><span data-stu-id="e217f-137">In addition to the actual migration code that is stored in the main code file, migrations also generates some additional code-behind files.</span></span> <span data-ttu-id="e217f-138">Diese Dateien sind Metadaten, die von Migrationen verwendet wird, und es sind nicht etwas, die Sie bearbeiten sollte.</span><span class="sxs-lookup"><span data-stu-id="e217f-138">These files are metadata that is used by migrations and are not something you should edit.</span></span> <span data-ttu-id="e217f-139">Eine dieser Dateien ist eine Ressourcendatei (.resx), die eine Momentaufnahme des Modells zum Zeitpunkt enthält, die die Migration wurde generiert.</span><span class="sxs-lookup"><span data-stu-id="e217f-139">One of these files is a resource file (.resx) that contains a snapshot of the model at the time the migration was generated.</span></span> <span data-ttu-id="e217f-140">Sie werden sehen, wie dies im nächsten Schritt verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="e217f-140">You’ll see how this is used in the next step.</span></span>

<span data-ttu-id="e217f-141">An dieser Stelle würden Sie wahrscheinlich ausführen **Update-Database** gelten die Änderungen für die Datenbank, und wechseln dann zu anderen Bereichen Ihrer Anwendung implementieren.</span><span class="sxs-lookup"><span data-stu-id="e217f-141">At this point you would probably run **Update-Database** to apply your changes to the database, and then go about implementing other areas of your application.</span></span>

### <a name="subsequent-migrations"></a><span data-ttu-id="e217f-142">Nachfolgende Migrationen</span><span class="sxs-lookup"><span data-stu-id="e217f-142">Subsequent migrations</span></span>

<span data-ttu-id="e217f-143">Später zurückkehren, und einige Änderungen an Ihrem Modell vornehmen – in unserem Beispiel fügen wir eine **Url** Eigenschaft **Blog**.</span><span class="sxs-lookup"><span data-stu-id="e217f-143">Later you come back and make some changes to your model – in our example we’ll add a **Url** property to **Blog**.</span></span> <span data-ttu-id="e217f-144">Klicken Sie dann geben Sie einen Befehl wie z. B. **Add-Migration AddUrl** Änderungen per Gerüstbau eine Migration zum Anwenden der entsprechenden Datenbank einrichten.</span><span class="sxs-lookup"><span data-stu-id="e217f-144">You would then issue a command such as **Add-Migration AddUrl** to scaffold a migration to apply the corresponding database changes.</span></span> <span data-ttu-id="e217f-145">Die allgemeinen Schritte, die mit diesem Befehl wird, sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="e217f-145">The high level steps that this command performs are pictured below.</span></span>

![Zweite Migration](~/ef6/media/secondmigration.png)

<span data-ttu-id="e217f-147">Nur wie beim letzten Mal wird das aktuelle Modell von Code (1) berechnet.</span><span class="sxs-lookup"><span data-stu-id="e217f-147">Just like last time, the current model is calculated from code (1).</span></span> <span data-ttu-id="e217f-148">Aber dieses Mal sind vorhandene Migrationen, sodass das vorherige Modell aus der letzten Migration (2) abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="e217f-148">However, this time there are existing migrations so the previous model is retrieved from the latest migration (2).</span></span> <span data-ttu-id="e217f-149">Diese beiden Modelle sind mit die erforderlichen datenbankänderungen (3) finden, und klicken Sie dann den Vorgang abschließt wie zuvor.</span><span class="sxs-lookup"><span data-stu-id="e217f-149">These two models are diffed to find the required database changes (3) and then the process completes as before.</span></span>

<span data-ttu-id="e217f-150">Dieser Prozess wird für alle weiteren Migrationen verwendet, die Sie dem Projekt hinzu.</span><span class="sxs-lookup"><span data-stu-id="e217f-150">This same process is used for any further migrations that you add to the project.</span></span>

### <a name="why-bother-with-the-model-snapshot"></a><span data-ttu-id="e217f-151">Wozu benötigen Sie die Momentaufnahme des Modells?</span><span class="sxs-lookup"><span data-stu-id="e217f-151">Why bother with the model snapshot?</span></span>

<span data-ttu-id="e217f-152">Sie vielleicht, warum draußen von EF mit der Momentaufnahme des Modells – Warum suchen Sie in der Datenbank nicht einfach.</span><span class="sxs-lookup"><span data-stu-id="e217f-152">You may be wondering why EF bothers with the model snapshot – why not just look at the database.</span></span> <span data-ttu-id="e217f-153">Wenn dies der Fall, lesen Sie weiter.</span><span class="sxs-lookup"><span data-stu-id="e217f-153">If so, read on.</span></span> <span data-ttu-id="e217f-154">Wenn Sie nicht interessiert sind, können Sie diesen Abschnitt überspringen.</span><span class="sxs-lookup"><span data-stu-id="e217f-154">If you’re not interested then you can skip this section.</span></span>

<span data-ttu-id="e217f-155">Es gibt zahlreiche Gründe, aus denen EF die Momentaufnahme des Modells um behält:</span><span class="sxs-lookup"><span data-stu-id="e217f-155">There are a number of reasons EF keeps the model snapshot around:</span></span>

-   <span data-ttu-id="e217f-156">Sie können Ihre Datenbank aus dem EF-Modell abweichen.</span><span class="sxs-lookup"><span data-stu-id="e217f-156">It allows your database to drift from the EF model.</span></span> <span data-ttu-id="e217f-157">Diese Änderungen können direkt in der Datenbank vorgenommen werden, oder Sie können den eingerüsteten Code ändern, in Ihrer Migrationen, um die Änderungen vorzunehmen.</span><span class="sxs-lookup"><span data-stu-id="e217f-157">These changes can be made directly in the database, or you can change the scaffolded code in your migrations to make the changes.</span></span> <span data-ttu-id="e217f-158">Hier sind einige Beispiele der in der Praxis:</span><span class="sxs-lookup"><span data-stu-id="e217f-158">Here are a couple of examples of this in practice:</span></span>
    -   <span data-ttu-id="e217f-159">Ein eingefügter und aktualisierte Spalte an eine oder mehrere Tabellen hinzufügen möchten, aber keine dieser Spalten in der EF-Datenmodell enthalten sein sollen.</span><span class="sxs-lookup"><span data-stu-id="e217f-159">You want to add an Inserted and Updated to column to one or more of your tables but you don’t want to include these columns in the EF model.</span></span> <span data-ttu-id="e217f-160">Wenn die Datenbank Migrationen, die es ständig versuchen würde betrachtet, diese Spalten zu löschen, jedes Mal, wenn Sie eine Migration erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="e217f-160">If migrations looked at the database it would continually try to drop these columns every time you scaffolded a migration.</span></span> <span data-ttu-id="e217f-161">Verwenden die Momentaufnahme des Modells, erkennt EF nur legitime Änderungen am Modell.</span><span class="sxs-lookup"><span data-stu-id="e217f-161">Using the model snapshot, EF will only ever detect legitimate changes to the model.</span></span>
    -   <span data-ttu-id="e217f-162">Ändern Sie den Text einer gespeicherten Prozedur, die für Updates verwendet, um einige Protokollierung einschließen möchten.</span><span class="sxs-lookup"><span data-stu-id="e217f-162">You want to change the body of a stored procedure used for updates to include some logging.</span></span> <span data-ttu-id="e217f-163">Wenn diese gespeicherte Prozedur aus der Datenbank Migrationen betrachtet kontinuierlich, wieder zurück auf die Definition, die von EF erwartet zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="e217f-163">If migrations looked at this stored procedure from the database it would continually try and reset it back to the definition that EF expects.</span></span> <span data-ttu-id="e217f-164">Verwenden Sie die Momentaufnahme des Modells, Gerüst die EF wird immer nur Code, um die gespeicherte Prozedur zu ändern, wenn Sie die Form der Prozedur in der EF-Modell zu ändern.</span><span class="sxs-lookup"><span data-stu-id="e217f-164">By using the model snapshot, EF will only ever scaffold code to alter the stored procedure when you change the shape of the procedure in the EF model.</span></span>
    -   <span data-ttu-id="e217f-165">Diese gleichen Prinzipien gelten für Hinzufügen von zusätzlichen Indizes, einschließlich zusätzliche Tabellen in der Datenbank, zum Zuordnen von EF zu einer Datenbanksicht, die über eine Tabelle usw. befindet.</span><span class="sxs-lookup"><span data-stu-id="e217f-165">These same principles apply to adding extra indexes, including extra tables in your database, mapping EF to a database view that sits over a table, etc.</span></span>
-   <span data-ttu-id="e217f-166">Das EF-Modell enthält mehr als nur die Form der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="e217f-166">The EF model contains more than just the shape of the database.</span></span> <span data-ttu-id="e217f-167">Müssen das gesamte Modell kann die Migrationen zu Informationen über die Eigenschaften und Klassen in Ihrem Modell und wie sie die Spalten und Tabellen zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="e217f-167">Having the entire model allows migrations to look at information about the properties and classes in your model and how they map to the columns and tables.</span></span> <span data-ttu-id="e217f-168">Diese Informationen kann Migrationen intelligentere im Code sein, die sie erstellt das Gerüst für.</span><span class="sxs-lookup"><span data-stu-id="e217f-168">This information allows migrations to be more intelligent in the code that it scaffolds.</span></span> <span data-ttu-id="e217f-169">Wenn Sie den Namen der Spalte ändern, die eine Eigenschaft zu Migrationen zuordnet können z. B. das Umbenennen von erkennen, sehen, dass es sich um die gleiche Eigenschaft – etwas, die erfolgen kann ist, wenn Sie nur das Schema der Datenbank verfügen.</span><span class="sxs-lookup"><span data-stu-id="e217f-169">For example, if you change the name of the column that a property maps to migrations can detect the rename by seeing that it’s the same property – something that can’t be done if you only have the database schema.</span></span> 

## <a name="what-causes-issues-in-team-environments"></a><span data-ttu-id="e217f-170">Was bewirkt, dass Probleme in teamumgebungen</span><span class="sxs-lookup"><span data-stu-id="e217f-170">What causes issues in team environments</span></span>

<span data-ttu-id="e217f-171">Der Workflow, die in den vorherigen Abschnitt funktioniert hervorragend behandelt werden, wenn Sie einen einzelnen Entwickler, die eine Anwendung sind.</span><span class="sxs-lookup"><span data-stu-id="e217f-171">The workflow covered in the previous section works great when you are a single developer working on an application.</span></span> <span data-ttu-id="e217f-172">Dies funktioniert auch gut in einer teamumgebung, wenn Sie die einzige Person, die Änderungen an das Modell sind.</span><span class="sxs-lookup"><span data-stu-id="e217f-172">It also works well in a team environment if you are the only person making changes to the model.</span></span> <span data-ttu-id="e217f-173">In diesem Szenario können modelländerungen vornehmen, Migrationen zu generieren und diese an die quellcodeverwaltung zu senden.</span><span class="sxs-lookup"><span data-stu-id="e217f-173">In this scenario you can make model changes, generate migrations and submit them to your source control.</span></span> <span data-ttu-id="e217f-174">Andere Entwickler können Ihre Änderungen zu synchronisieren und ausführen **Update-Database** die schemaänderungen angewendet haben.</span><span class="sxs-lookup"><span data-stu-id="e217f-174">Other developers can sync your changes and run **Update-Database** to have the schema changes applied.</span></span>

<span data-ttu-id="e217f-175">Probleme beginnen auftreten, wenn mehrere Entwickler Änderungen an das EF-Modell, und übermitteln zur quellcodeverwaltung, zur gleichen Zeit.</span><span class="sxs-lookup"><span data-stu-id="e217f-175">Issues start to arise when you have multiple developers making changes to the EF model and submitting to source control at the same time.</span></span> <span data-ttu-id="e217f-176">Was verfügt nicht über die EF ist eine erstklassige Möglichkeit, Ihre lokalen Migrationen mit Migrationen zusammenzuführen, die ein anderer Entwickler in die quellcodeverwaltung gesendet hat, seit Sie zuletzt synchronisiert.</span><span class="sxs-lookup"><span data-stu-id="e217f-176">What EF lacks is a first class way to merge your local migrations with migrations that another developer has submitted to source control since you last synced.</span></span>

## <a name="an-example-of-a-merge-conflict"></a><span data-ttu-id="e217f-177">Ein Beispiel für ein Zusammenführungskonflikt</span><span class="sxs-lookup"><span data-stu-id="e217f-177">An example of a merge conflict</span></span>

<span data-ttu-id="e217f-178">Zuerst sehen wir uns diese eines Mergekonflikts ein konkretes Beispiel.</span><span class="sxs-lookup"><span data-stu-id="e217f-178">First let’s look at a concrete example of such a merge conflict.</span></span> <span data-ttu-id="e217f-179">Wir werden auf das Beispiel weiterhin, die, denen uns zuvor betrachtete.</span><span class="sxs-lookup"><span data-stu-id="e217f-179">We’ll continue on with the example we looked at earlier.</span></span> <span data-ttu-id="e217f-180">Als Ausgangspunkt zeigen wir davon aus, die Änderungen aus dem vorherigen Abschnitt wurden vom ursprünglichen Entwickler eingecheckt.</span><span class="sxs-lookup"><span data-stu-id="e217f-180">As a starting point let’s assume the changes from the previous section were checked in by the original developer.</span></span> <span data-ttu-id="e217f-181">Wir werden zwei Entwickler verfolgen, wie sie Änderungen an Code Codebasis vornehmen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="e217f-181">We’ll track two developers as they make changes to code base.</span></span>

<span data-ttu-id="e217f-182">Das EF-Modell und die Migrationen über eine Reihe von Änderungen nachverfolgt.</span><span class="sxs-lookup"><span data-stu-id="e217f-182">We’ll track the EF model and the migrations thru a number of changes.</span></span> <span data-ttu-id="e217f-183">Für einen Ausgangspunkt haben sowohl Entwickler als auch mit den Quellcodeverwaltungs-Repository, synchronisiert, wie in der folgenden Abbildung dargestellt ist.</span><span class="sxs-lookup"><span data-stu-id="e217f-183">For a starting point, both developers have synced to the source control repository, as depicted in the following graphic.</span></span>

![Startpunkt](~/ef6/media/startingpoint.png)

<span data-ttu-id="e217f-185">Entwickler \#1 und Entwickler \#2 jetzt nimmt einige Änderungen an das EF-Modell in ihrem lokalen Code Basis.</span><span class="sxs-lookup"><span data-stu-id="e217f-185">Developer \#1 and developer \#2 now makes some changes to the EF model in their local code base.</span></span> <span data-ttu-id="e217f-186">Entwickler \#1 fügt eine **Bewertung** Eigenschaft **Blog** – und generiert eine **AddRating** Migration, um die Änderungen auf die Datenbank anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="e217f-186">Developer \#1 adds a **Rating** property to **Blog** – and generates an **AddRating** migration to apply the changes to the database.</span></span> <span data-ttu-id="e217f-187">Entwickler \#2 Fügt eine **Leser** Eigenschaft **Blog** – und generiert den entsprechenden **AddReaders** Migration.</span><span class="sxs-lookup"><span data-stu-id="e217f-187">Developer \#2 adds a **Readers** property to **Blog** – and generates the corresponding **AddReaders** migration.</span></span> <span data-ttu-id="e217f-188">Führen Sie sowohl Entwickler als auch **Update-Database**, zum Anwenden der Änderungen auf ihren lokalen Datenbanken, und fahren die Entwicklung der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="e217f-188">Both developers run **Update-Database**, to apply the changes to their local databases, and then continue developing the application.</span></span>

> [!NOTE]
> <span data-ttu-id="e217f-189">Migrationen werden mit dem Präfix mit einem Zeitstempel, damit, die die Grafik darstellt der AddReaders-Migration von Developer \#2 wird nach der Migration AddRating Entwickler \#1.</span><span class="sxs-lookup"><span data-stu-id="e217f-189">Migrations are prefixed with a timestamp, so our graphic represents that the AddReaders migration from Developer \#2 comes after the AddRating migration from Developer \#1.</span></span> <span data-ttu-id="e217f-190">Ob Entwickler \#1 oder \#2 generiert die erste Migration macht keinerlei Auswirkung auf die Lösung von Problemen in einem Team oder der Prozess zum Zusammenführen, die wir im nächsten Abschnitt betrachten werde.</span><span class="sxs-lookup"><span data-stu-id="e217f-190">Whether developer \#1 or \#2 generated the migration first makes no difference to the issues of working in a team, or the process for merging them that we’ll look at in the next section.</span></span>

![Lokale Änderungen](~/ef6/media/localchanges.png)

<span data-ttu-id="e217f-192">Es ist ein Glück Tag für Entwickler \#1 wiedergibt, um ihre Änderungen zuerst zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="e217f-192">It’s a lucky day for Developer \#1 as they happen to submit their changes first.</span></span> <span data-ttu-id="e217f-193">Da es sich bei keinem anderen Benutzer eingecheckt wurde, da sie ihrem Repository synchronisiert, können sie einfach ihre Änderungen senden, ohne jede zusammenführen.</span><span class="sxs-lookup"><span data-stu-id="e217f-193">Because no one else has checked in since they synced their repository, they can just submit their changes without performing any merging.</span></span>

![Senden](~/ef6/media/submit.png)

<span data-ttu-id="e217f-195">Nun ist es Zeit für Entwickler \#2 zu übermitteln.</span><span class="sxs-lookup"><span data-stu-id="e217f-195">Now it’s time for Developer \#2 to submit.</span></span> <span data-ttu-id="e217f-196">Sie sind nicht so viel Glück.</span><span class="sxs-lookup"><span data-stu-id="e217f-196">They aren’t so lucky.</span></span> <span data-ttu-id="e217f-197">Da eine andere Person Änderungen übermittelt hat, da sie synchronisiert, müssen sie die Änderungen und Merge per pull abgerufen.</span><span class="sxs-lookup"><span data-stu-id="e217f-197">Because someone else has submitted changes since they synced, they will need to pull down the changes and merge.</span></span> <span data-ttu-id="e217f-198">Das Quellcodeverwaltungssystem wird wahrscheinlich in der Lage, die Änderungen auf der Codeebene automatisch zusammenzuführen, da sie sehr einfach sind.</span><span class="sxs-lookup"><span data-stu-id="e217f-198">The source control system will likely be able to automatically merge the changes at the code level since they are very simple.</span></span> <span data-ttu-id="e217f-199">Der Status des Entwicklers \#2 des lokalen Repository nach der Synchronisierung in der folgenden Abbildung dargestellt ist.</span><span class="sxs-lookup"><span data-stu-id="e217f-199">The state of Developer \#2’s local repository after syncing is depicted in the following graphic.</span></span> 

![Pull](~/ef6/media/pull.png)

<span data-ttu-id="e217f-201">Auf dieser Stufe Developer \#2 ausführen können **Update-Database** erkennt die neuen **AddRating** Migration (die wurde nicht angewendet. Entwickler \#2 Datenbank) und diese anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="e217f-201">At this stage Developer \#2 can run **Update-Database** which will detect the new **AddRating** migration (which hasn’t been applied to Developer \#2’s database) and apply it.</span></span> <span data-ttu-id="e217f-202">Jetzt die **Bewertung** Spalte wird hinzugefügt, um die **Blogs** Tabelle und die Datenbank ist mit dem Modell.</span><span class="sxs-lookup"><span data-stu-id="e217f-202">Now the **Rating** column is added to the **Blogs** table and the database is in sync with the model.</span></span>

<span data-ttu-id="e217f-203">Es gibt jedoch einige Probleme:</span><span class="sxs-lookup"><span data-stu-id="e217f-203">There are a couple of problems though:</span></span>

1.  <span data-ttu-id="e217f-204">Obwohl **Update-Database** gelten die **AddRating** Migration wird es auch eine Warnung ausgelöst: *kann nicht zum Aktualisieren der Datenbank, um das aktuelle Modell übereinstimmen, da es ausstehende Änderungen gibt und Automatische Migration wird deaktiviert...*</span><span class="sxs-lookup"><span data-stu-id="e217f-204">Although **Update-Database** will apply the **AddRating** migration it will also raise a warning: *Unable to update database to match the current model because there are pending changes and automatic migration is disabled…*</span></span>
    <span data-ttu-id="e217f-205">Das Problem besteht darin, dass die Momentaufnahme des Modells in der letzten Migration gespeichert (**AddReader**) fehlt die **Bewertung** Eigenschaft **Blog** (da er Teil des Modells wurde nicht beim der Migration generiert wurde).</span><span class="sxs-lookup"><span data-stu-id="e217f-205">The problem is that the model snapshot stored in the last migration (**AddReader**) is missing the **Rating** property on **Blog** (since it wasn’t part of the model when the migration was generated).</span></span> <span data-ttu-id="e217f-206">Code erkennt zuerst an, dass das Modell in der letzten Migration nicht das aktuelle Modell entspricht und die Warnung auslöst.</span><span class="sxs-lookup"><span data-stu-id="e217f-206">Code First detects that the model in the last migration doesn’t match the current model and raises the warning.</span></span>
2.  <span data-ttu-id="e217f-207">Ausführen der Anwendung führt zu einer InvalidOperationException, die besagt, dass "*des Modells, das den Kontext 'BloggingContext' unterstützt wurde geändert, da die Datenbank erstellt wurde. Erwägen Sie die Verwendung von Code First-Migrationen zum Aktualisieren der Datenbank..."*</span><span class="sxs-lookup"><span data-stu-id="e217f-207">Running the application would result in an InvalidOperationException stating that “*The model backing the 'BloggingContext' context has changed since the database was created. Consider using Code First Migrations to update the database…”*</span></span>
    <span data-ttu-id="e217f-208">In diesem Fall wird das Problem der modellmomentaufnahme in der letzten Migration gespeichert, das aktuelle Modell entspricht.</span><span class="sxs-lookup"><span data-stu-id="e217f-208">Again, the problem is the model snapshot stored in the last migration doesn’t match the current model.</span></span>
3.  <span data-ttu-id="e217f-209">Schließlich erwarten wir, Ausführung **Add-Migration** jetzt generiert eine leere Migration (da es keine Änderungen auf die Datenbank anwenden sind).</span><span class="sxs-lookup"><span data-stu-id="e217f-209">Finally, we would expect running **Add-Migration** now would generate an empty migration (since there are no changes to apply to the database).</span></span> <span data-ttu-id="e217f-210">Aber da Migrationen vergleicht das aktuelle Modell auf den von der letzten Migration (die ist nicht vorhanden der **Bewertung** Eigenschaft) Es ist tatsächlich Erstellen des Gerüsts für eine andere **AddColumn** Aufruf zum Hinzufügen in der **Bewertung** Spalte.</span><span class="sxs-lookup"><span data-stu-id="e217f-210">But because migrations compares the current model to the one from the last migration (which is missing the **Rating** property) it will actually scaffold another **AddColumn** call to add in the **Rating** column.</span></span> <span data-ttu-id="e217f-211">Natürlich würde diese Migration während fehlschlagen **Update-Database** da die **Bewertung** Spalte ist bereits vorhanden.</span><span class="sxs-lookup"><span data-stu-id="e217f-211">Of course, this migration would fail during **Update-Database** because the **Rating** column already exists.</span></span>

## <a name="resolving-the-merge-conflict"></a><span data-ttu-id="e217f-212">Den Merge-Konflikt auflösen</span><span class="sxs-lookup"><span data-stu-id="e217f-212">Resolving the merge conflict</span></span>

<span data-ttu-id="e217f-213">Die gute Nachricht ist, dass es nicht zu schwierig, die den Merge manuell – Behandlung bereitgestellt haben Sie einen Überblick über die Funktionsweise von Migrationen.</span><span class="sxs-lookup"><span data-stu-id="e217f-213">The good news is that it’s not too hard to deal with the merge manually – provided you have an understanding of how migrations works.</span></span> <span data-ttu-id="e217f-214">Wenn Sie direkt zu diesem Abschnitt übersprungen haben...</span><span class="sxs-lookup"><span data-stu-id="e217f-214">So if you’ve skipped ahead to this section…</span></span> <span data-ttu-id="e217f-215">Leider müssen Sie zurückkehren und den Rest dieses Artikels zunächst lesen!</span><span class="sxs-lookup"><span data-stu-id="e217f-215">sorry, you need to go back and read the rest of the article first!</span></span>

<span data-ttu-id="e217f-216">Es gibt zwei Möglichkeiten, eine leere Migration zu generieren, das richtige aktuelle Modell als eine Momentaufnahme der einfachste Weg ist.</span><span class="sxs-lookup"><span data-stu-id="e217f-216">There are two options, the easiest is to generate a blank migration that has the correct current model as a snapshot.</span></span> <span data-ttu-id="e217f-217">Die zweite Option ist beim Aktualisieren der Momentaufnahme in die letzte Migration, damit die richtige Momentaufnahme des Modells.</span><span class="sxs-lookup"><span data-stu-id="e217f-217">The second option is to update the snapshot in the last migration to have the correct model snapshot.</span></span> <span data-ttu-id="e217f-218">Die zweite Option ist etwas komplizierter und kann nicht in jedem Szenario verwendet werden, aber es ist auch übersichtlicher, da es nicht erforderlich ist, Hinzufügen einer zusätzlichen Migrations.</span><span class="sxs-lookup"><span data-stu-id="e217f-218">The second option is a little harder and can’t be used in every scenario, but it’s also cleaner because it doesn’t involve adding an extra migration.</span></span>

### <a name="option-1-add-a-blank-merge-migration"></a><span data-ttu-id="e217f-219">Option 1: Hinzufügen einer leeren 'Merge'-Migrations</span><span class="sxs-lookup"><span data-stu-id="e217f-219">Option 1: Add a blank ‘merge’ migration</span></span>

<span data-ttu-id="e217f-220">Bei dieser Option generiert eine leere Migration ausschließlich zum Zweck der sicherstellen, dass die neueste Migration verfügt über die Momentaufnahme des richtigen Modells darin gespeichert.</span><span class="sxs-lookup"><span data-stu-id="e217f-220">In this option we generate a blank migration solely for the purpose of making sure the latest migration has the correct model snapshot stored in it.</span></span>

<span data-ttu-id="e217f-221">Diese Option kann unabhängig davon verwendet werden, die letzte Migration generiert hat.</span><span class="sxs-lookup"><span data-stu-id="e217f-221">This option can be used regardless of who generated the last migration.</span></span> <span data-ttu-id="e217f-222">Im Beispiel wir haben Entwickler nach wurde \#2 zuständig ist die Zusammenführung aus, und sie aufgetreten sind, um die letzte Migration zu generieren.</span><span class="sxs-lookup"><span data-stu-id="e217f-222">In the example we’ve been following Developer \#2 is taking care of the merge and they happened to generate the last migration.</span></span> <span data-ttu-id="e217f-223">Aber die gleichen Schritte können verwendet werden, wenn Entwickler \#1 generiert, die letzte Migration.</span><span class="sxs-lookup"><span data-stu-id="e217f-223">But these same steps can be used if Developer \#1 generated the last migration.</span></span> <span data-ttu-id="e217f-224">Die Schritte gelten auch, wenn mehrere livemigrationen beteiligt sind – wir nur zwei gesucht wurde, haben um einfach zu halten.</span><span class="sxs-lookup"><span data-stu-id="e217f-224">The steps also apply if there are multiple migrations involved – we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="e217f-225">Für diesen Ansatz, beginnend ab dem Zeitpunkt, der Sie feststellen, dass Sie Änderungen vornehmen möchten, die aus der quellcodeverwaltung synchronisiert werden müssen, kann der folgende Prozess verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e217f-225">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="e217f-226">Stellen Sie sicher, dass alle ausstehenden modelländerungen in Ihrer lokalen Codebasis für eine Migration geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="e217f-226">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="e217f-227">Dadurch wird sichergestellt, dass keine legitimen Änderungen nicht entgehen, wenn es Zeit, die zum Generieren der Migrations leer ist.</span><span class="sxs-lookup"><span data-stu-id="e217f-227">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="e217f-228">Synchronisieren Sie mit der quellcodeverwaltung.</span><span class="sxs-lookup"><span data-stu-id="e217f-228">Sync with source control.</span></span>
3.  <span data-ttu-id="e217f-229">Führen Sie **Update-Database** , alle neuen Migrationen anzuwenden, die andere Entwickler eingecheckt haben.</span><span class="sxs-lookup"><span data-stu-id="e217f-229">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="e217f-230">\*\*
    *Hinweis: \*\*\* Wenn Sie keine Warnungen, von der Update-Database-Befehl erhalten dann gab es keine neuen Migrationen von anderen Entwicklern und besteht keine Notwendigkeit zum Ausführen der weiter zusammenführen.*</span><span class="sxs-lookup"><span data-stu-id="e217f-230">\*\*
*Note:\*\*\*\*if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="e217f-231">Führen Sie **Add-Migration &lt;auswählen\_eine\_Namen&gt; – IgnoreChanges** (z. B. **Merge Add-Migration – IgnoreChanges**).</span><span class="sxs-lookup"><span data-stu-id="e217f-231">Run **Add-Migration &lt;pick\_a\_name&gt; –IgnoreChanges** (for example, **Add-Migration Merge –IgnoreChanges**).</span></span> <span data-ttu-id="e217f-232">Dies erzeugt eine Migration mit dem alle Metadaten (einschließlich einer Momentaufnahme des aktuellen Modells), jedoch ignoriert, dass alle Änderungen, die erkennt, wenn das aktuelle Modell mit Momentaufnahme in den letzten Migrationen zu vergleichen (d. h., Sie erhalten ein leeres **einrichten** und **Unten** Methode).</span><span class="sxs-lookup"><span data-stu-id="e217f-232">This generates a migration with all the metadata (including a snapshot of the current model) but will ignore any changes it detects when comparing the current model to the snapshot in the last migrations (meaning you get a blank **Up** and **Down** method).</span></span>
5.  <span data-ttu-id="e217f-233">Weiterentwickeln, oder Senden an die quellcodeverwaltung (nachdem Ihre Komponententests ausführen von tests).</span><span class="sxs-lookup"><span data-stu-id="e217f-233">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="e217f-234">Hier ist der Status des Entwicklers \#2 des lokalen Codebasis nach der Verwendung dieses Ansatzes.</span><span class="sxs-lookup"><span data-stu-id="e217f-234">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Zusammenführen der Migration](~/ef6/media/mergemigration.png)

### <a name="option-2-update-the-model-snapshot-in-the-last-migration"></a><span data-ttu-id="e217f-236">Option 2: Aktualisieren der modellmomentaufnahme in der letzten migration</span><span class="sxs-lookup"><span data-stu-id="e217f-236">Option 2: Update the model snapshot in the last migration</span></span>

<span data-ttu-id="e217f-237">Diese Option ist sehr ähnlich, Option 1, aber die zusätzliche leere Migration – entfernt, da seien wir ehrlich, zusätzlichen Code-Dateien in ihre Projektmappe möchte.</span><span class="sxs-lookup"><span data-stu-id="e217f-237">This option is very similar to option 1 but removes the extra blank migration – because let’s face it, who wants extra code files in their solution.</span></span>

<span data-ttu-id="e217f-238">**Dieser Ansatz ist nur möglich, wenn die neueste Migration ist nur in Ihrer lokalen Codebasis vorhanden und noch nicht, Datenquellen-Steuerelement übermittelt wurde (z. B., wenn die letzte Migration durch den Benutzer, die die Zusammenführung ausführen generiert wurde)**.</span><span class="sxs-lookup"><span data-stu-id="e217f-238">**This approach is only feasible if the latest migration exists only in your local code base and has not yet been submitted to source control (for example, if the last migration was generated by the user doing the merge)**.</span></span> <span data-ttu-id="e217f-239">Bearbeiten Sie die Metadaten für Migrationen, die andere Entwickler möglicherweise bereits in ihrer Entwicklungsdatenbank – oder sogar angewendet haben kann auf eine Produktionsdatenbank – noch schlimmer ist angewendet unerwartete Nebeneffekte führen.</span><span class="sxs-lookup"><span data-stu-id="e217f-239">Editing the metadata of migrations that other developers may have already applied to their development database – or even worse applied to a production database – can result in unexpected side effects.</span></span> <span data-ttu-id="e217f-240">Während des Prozesses stellen wir zum Rollback für der letzten Migrations in der lokalen Datenbank, und wenden Sie es erneut mit der aktualisierten Metadaten.</span><span class="sxs-lookup"><span data-stu-id="e217f-240">During the process we’re going to roll back the last migration in our local database and re-apply it with updated metadata.</span></span>

<span data-ttu-id="e217f-241">Während die letzte Migration einfach muss sein, in der lokalen Codebasis bestehen keine Einschränkungen der Anzahl oder Reihenfolge der Migrationen, bei die sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="e217f-241">While the last migration needs to just be in the local code base there are no restrictions to the number or order of migrations that proceed it.</span></span> <span data-ttu-id="e217f-242">Es können mehrere livemigrationen von mehreren anderen Entwicklern vorhanden sein und die gleichen Schritte gelten – wir haben nur zwei gesucht wurde, um einfach zu halten.</span><span class="sxs-lookup"><span data-stu-id="e217f-242">There can be multiple migrations from multiple different developers and the same steps apply– we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="e217f-243">Für diesen Ansatz, beginnend ab dem Zeitpunkt, der Sie feststellen, dass Sie Änderungen vornehmen möchten, die aus der quellcodeverwaltung synchronisiert werden müssen, kann der folgende Prozess verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e217f-243">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="e217f-244">Stellen Sie sicher, dass alle ausstehenden modelländerungen in Ihrer lokalen Codebasis für eine Migration geschrieben wurden.</span><span class="sxs-lookup"><span data-stu-id="e217f-244">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="e217f-245">Dadurch wird sichergestellt, dass keine legitimen Änderungen nicht entgehen, wenn es Zeit, die zum Generieren der Migrations leer ist.</span><span class="sxs-lookup"><span data-stu-id="e217f-245">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="e217f-246">Synchronisieren Sie mit dem Datenquellen-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="e217f-246">Sync with the source control.</span></span>
3.  <span data-ttu-id="e217f-247">Führen Sie **Update-Database** , alle neuen Migrationen anzuwenden, die andere Entwickler eingecheckt haben.</span><span class="sxs-lookup"><span data-stu-id="e217f-247">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="e217f-248">\*\*
    *Hinweis: \*\*\* Wenn Sie keine Warnungen, von der Update-Database-Befehl erhalten dann gab es keine neuen Migrationen von anderen Entwicklern und besteht keine Notwendigkeit zum Ausführen der weiter zusammenführen.*</span><span class="sxs-lookup"><span data-stu-id="e217f-248">\*\*
*Note:\*\*\*\*if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="e217f-249">Führen Sie **Update-Database – TargetMigration &lt;zweite\_letzten\_Migration&gt;**  (im Beispiel wir haben nach wurde dies wäre **Update-Database: TargetMigration AddRating**).</span><span class="sxs-lookup"><span data-stu-id="e217f-249">Run **Update-Database –TargetMigration &lt;second\_last\_migration&gt;** (in the example we’ve been following this would be **Update-Database –TargetMigration AddRating**).</span></span> <span data-ttu-id="e217f-250">Diese Rollen, die die Datenbank wieder in den Zustand der zweiten der letzten Migration – effektiv "nicht anwenden" der letzten Migrations aus der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="e217f-250">This roles the database back to the state of the second last migration – effectively ‘un-applying’ the last migration from the database.</span></span>
    <span data-ttu-id="e217f-251">\*\*
    *Hinweis: \*\*\* Dieser Schritt ist erforderlich, um es sicher so bearbeiten Sie die Metadaten der Migration, da die Metadaten auch in gespeichert ist die \_ \_MigrationsHistoryTable der Datenbank. Daher ist diese Option nur verwenden sollten, ist die letzte Migration nur in der lokalen Codebasis. Wenn andere Datenbanken die letzte Migration angewendet haben, müssten Sie auch zum Rollback für sie und wenden Sie die letzte Migration zum Aktualisieren der Metadaten.*</span><span class="sxs-lookup"><span data-stu-id="e217f-251">\*\*
*Note:\*\*\*\*This step is required to make it safe to edit the metadata of the migration since the metadata is also stored in the \_\_MigrationsHistoryTable of the database. This is why you should only use this option if the last migration is only in your local code base. If other databases had the last migration applied you would also have to roll them back and re-apply the last migration to update the metadata.*</span></span> 
5.  <span data-ttu-id="e217f-252">Führen Sie **Add-Migration &lt;vollständige\_Namen\_einschließlich\_Zeitstempel\_von\_letzten\_Migration** &gt; (im Beispiel Wir haben folgende wurde dies wäre etwa **Add-Migration 201311062215252\_AddReaders**).</span><span class="sxs-lookup"><span data-stu-id="e217f-252">Run **Add-Migration &lt;full\_name\_including\_timestamp\_of\_last\_migration**&gt; (in the example we’ve been following this would be something like **Add-Migration 201311062215252\_AddReaders**).</span></span>
    <span data-ttu-id="e217f-253">\*\*
    *Hinweis: \*\*\* müssen Sie die Zeitstempel enthalten, sodass Migrationen weiß, dass der Gerüstbau eine neue, anstatt die vorhandene Migration bearbeitet werden soll.*</span><span class="sxs-lookup"><span data-stu-id="e217f-253">\*\*
    *Note:\*\*\*\*You need to include the timestamp so that migrations knows you want to edit the existing migration rather than scaffolding a new one.*</span></span>
<span data-ttu-id="e217f-254">Dadurch werden die Metadaten für die letzte Migration das aktuelle Modell entsprechend aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="e217f-254">This will update the metadata for the last migration to match the current model.</span></span> <span data-ttu-id="e217f-255">Sie erhalten die folgende Warnung, wenn der Befehl abgeschlossen ist, aber das ist genau das, erwünscht.</span><span class="sxs-lookup"><span data-stu-id="e217f-255">You’ll get the following warning when the command completes, but that’s exactly what you want.</span></span> <span data-ttu-id="e217f-256">"*Nur der Designer-Code für die Migration" 201311062215252\_AddReaders wurde erneut erstellten. Um die gesamte Migration erneut ein Gerüst erstellen, verwenden Sie den - Force-Parameter. "*</span><span class="sxs-lookup"><span data-stu-id="e217f-256">“*Only the Designer Code for migration '201311062215252\_AddReaders' was re-scaffolded. To re-scaffold the entire migration, use the -Force parameter.”*</span></span>
6.  <span data-ttu-id="e217f-257">Führen Sie **Update-Database** die neueste Migration mit den aktualisierten Metadaten erneut anwenden.</span><span class="sxs-lookup"><span data-stu-id="e217f-257">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
7.  <span data-ttu-id="e217f-258">Weiterentwickeln, oder Senden an die quellcodeverwaltung (nachdem Ihre Komponententests ausführen von tests).</span><span class="sxs-lookup"><span data-stu-id="e217f-258">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="e217f-259">Hier ist der Status des Entwicklers \#2 des lokalen Codebasis nach der Verwendung dieses Ansatzes.</span><span class="sxs-lookup"><span data-stu-id="e217f-259">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Metadaten wurden aktualisiert](~/ef6/media/updatedmetadata.png)

## <a name="summary"></a><span data-ttu-id="e217f-261">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="e217f-261">Summary</span></span>

<span data-ttu-id="e217f-262">Es sind einige Probleme auf, wenn Sie Code First-Migrationen in einer teamumgebung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="e217f-262">There are some challenges when using Code First Migrations in a team environment.</span></span> <span data-ttu-id="e217f-263">Jedoch ein grundlegendes Verständnis der Funktionsweise von Migrationen und einige einfache Methoden zum Auflösen von Zusammenführungskonflikten erleichtern Ihnen diese Herausforderungen zu bewältigen.</span><span class="sxs-lookup"><span data-stu-id="e217f-263">However, a basic understanding of how migrations works and some simple approaches for resolving merge conflicts make it easy to overcome these challenges.</span></span>

<span data-ttu-id="e217f-264">Das grundlegende Problem ist nicht korrekt in die neueste Migration gespeicherten Metadaten.</span><span class="sxs-lookup"><span data-stu-id="e217f-264">The fundamental issue is incorrect metadata stored in the latest migration.</span></span> <span data-ttu-id="e217f-265">Dies bewirkt, dass Code First fälschlicherweise anzeigt, dass das aktuelle Modell und das Datenbankschema nicht übereinstimmen und falschen Code in der nächsten Migration erstellen.</span><span class="sxs-lookup"><span data-stu-id="e217f-265">This causes Code First to incorrectly detect that the current model and database schema don’t match and to scaffold incorrect code in the next migration.</span></span> <span data-ttu-id="e217f-266">Diese Situation kann durch eine leere Migration mit dem richtigen Modell generieren oder Aktualisieren der Metadaten in der letzten Migration überwunden werden.</span><span class="sxs-lookup"><span data-stu-id="e217f-266">This situation can be overcome by generating a blank migration with the correct model, or updating the metadata in the latest migration.</span></span>
