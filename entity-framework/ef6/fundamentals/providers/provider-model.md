---
title: Das Entity Framework 6-Anbietermodell - EF6
author: divega
ms.date: 06/27/2018
ms.assetid: 066832F0-D51B-4655-8BE7-C983C557E0E4
ms.openlocfilehash: 8cbf6f87e0936f374c3d8a0c15a0e1d9c828f764
ms.sourcegitcommit: 159c2e9afed7745e7512730ffffaf154bcf2ff4a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/03/2019
ms.locfileid: "55668751"
---
# <a name="the-entity-framework-6-provider-model"></a><span data-ttu-id="ee56b-102">Das Entity Framework 6-Anbietermodell</span><span class="sxs-lookup"><span data-stu-id="ee56b-102">The Entity Framework 6 provider model</span></span>

<span data-ttu-id="ee56b-103">Das Entity Framework-Anbieter ermöglicht Entity Framework, mit verschiedenen Typen von Datenbank-Server verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-103">The Entity Framework provider model allows Entity Framework to be used with different types of database server.</span></span> <span data-ttu-id="ee56b-104">Beispielsweise kann ein Anbieter angeschlossen werden, können Sie EF für Microsoft SQL Server verwendet werden, während ein anderer Anbieter in integriert werden kann, um EF für Microsoft SQL Server Compact Edition verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="ee56b-104">For example, one provider can be plugged in to allow EF to be used against Microsoft SQL Server, while another provider can be plugged into to allow EF to be used against Microsoft SQL Server Compact Edition.</span></span> <span data-ttu-id="ee56b-105">Die Anbieter für EF 6, die wir kennen finden Sie auf die [Entity Framework-Anbieter](~/ef6/fundamentals/providers/index.md) Seite.</span><span class="sxs-lookup"><span data-stu-id="ee56b-105">The providers for EF6 that we are aware of can be found on the [Entity Framework providers](~/ef6/fundamentals/providers/index.md) page.</span></span>

<span data-ttu-id="ee56b-106">Bestimmte Änderungen waren notwendig, um die Möglichkeit, die EF interagiert, Anbieter von EF unter einer open-Source-Lizenz freigegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="ee56b-106">Certain changes were required to the way EF interacts with providers to allow EF to be released under an open source license.</span></span> <span data-ttu-id="ee56b-107">Diese Änderungen erfordern die Neuerstellung des EF-Anbieter für die EF6-Assemblys sowie neue Mechanismen für die Registrierung des Anbieters.</span><span class="sxs-lookup"><span data-stu-id="ee56b-107">These changes require rebuilding of EF providers against the EF6 assemblies together with new mechanisms for registration of the provider.</span></span>

## <a name="rebuilding"></a><span data-ttu-id="ee56b-108">Neu erstellen</span><span class="sxs-lookup"><span data-stu-id="ee56b-108">Rebuilding</span></span>

<span data-ttu-id="ee56b-109">Mit EF6 ist die Core-Code, der zuvor Teil von .NET Framework war jetzt als Out-of-Band (OOB) Assemblys versendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-109">With EF6 the core code that was previously part of the .NET Framework is now being shipped as out-of-band (OOB) assemblies.</span></span> <span data-ttu-id="ee56b-110">Informationen zum Erstellen von Anwendungen für EF6 finden Sie auf die [Aktualisieren von Anwendungen für EF6](~/ef6/what-is-new/upgrading-to-ef6.md) Seite.</span><span class="sxs-lookup"><span data-stu-id="ee56b-110">Details on how to build applications against EF6 can be found on the [Updating applications for EF6](~/ef6/what-is-new/upgrading-to-ef6.md) page.</span></span> <span data-ttu-id="ee56b-111">Anbieter müssen auch neu erstellt werden, die mithilfe der Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-111">Providers will also need to be rebuilt using these instructions.</span></span>

## <a name="provider-types-overview"></a><span data-ttu-id="ee56b-112">Übersicht über Steuerelementtypen für Anbieter</span><span class="sxs-lookup"><span data-stu-id="ee56b-112">Provider types overview</span></span>

<span data-ttu-id="ee56b-113">Ein EF-Anbieter ist wirklich eine Sammlung von anbieterspezifischen-Diensten, die definiert, die von CLR-Typen, die diese Dienste erweitern aus (für eine Basisklasse) oder (für eine Schnittstelle) implementieren.</span><span class="sxs-lookup"><span data-stu-id="ee56b-113">An EF provider is really a collection of provider-specific services defined by CLR types that these services extend from (for a base class) or implement (for an interface).</span></span> <span data-ttu-id="ee56b-114">Zwei dieser Dienste sind grundlegende und erforderlich für EF funktionsfähig.</span><span class="sxs-lookup"><span data-stu-id="ee56b-114">Two of these services are fundamental and necessary for EF to function at all.</span></span> <span data-ttu-id="ee56b-115">Andere sind optional und müssen nur implementiert werden, wenn bestimmte Funktionalität erforderlich ist, und/oder die standardimplementierungen dieser Dienste funktioniert nicht für den bestimmten Datenbankserver abgezielt wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-115">Others are optional and only need to be implemented if specific functionality is required and/or the default implementations of these services does not work for the specific database server being targeted.</span></span>

## <a name="fundamental-provider-types"></a><span data-ttu-id="ee56b-116">Grundlegende Anbietertypen</span><span class="sxs-lookup"><span data-stu-id="ee56b-116">Fundamental provider types</span></span>

### <a name="dbproviderfactory"></a><span data-ttu-id="ee56b-117">DbProviderFactory</span><span class="sxs-lookup"><span data-stu-id="ee56b-117">DbProviderFactory</span></span>

<span data-ttu-id="ee56b-118">EF ist das Vorhandensein von abgeleiteten Typs [System.Data.Common.DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) für die Durchführung aller Low-Level-Datenbankzugriff.</span><span class="sxs-lookup"><span data-stu-id="ee56b-118">EF depends on having a type derived from [System.Data.Common.DbProviderFactory](https://msdn.microsoft.com/library/system.data.common.dbproviderfactory.aspx) for performing all low-level database access.</span></span> <span data-ttu-id="ee56b-119">"DbProviderFactory" ist nicht Bestandteil von EF, sondern ist stattdessen eine Klasse in .NET Framework, die einem Einstiegspunkt für ADO.NET-Anbieter dient kann verwendet werden von EF, andere O/RMs oder direkt durch eine Anwendung zum Abrufen von Instanzen von Verbindungen, Befehle und Parameter und andere ADO.NET Abstraktionen in einem Anbieter hostagnostische Weise.</span><span class="sxs-lookup"><span data-stu-id="ee56b-119">DbProviderFactory is not actually part of EF but is instead a class in the .NET Framework that serves an entry point for ADO.NET providers that can be used by EF, other O/RMs or directly by an application to obtain instances of connections, commands, parameters and other ADO.NET abstractions in a provider agnostic way.</span></span> <span data-ttu-id="ee56b-120">Weitere Informationen zu "DbProviderFactory" befinden sich die [MSDN-Dokumentation für ADO.NET](https://msdn.microsoft.com/library/a6cd7c08.aspx).</span><span class="sxs-lookup"><span data-stu-id="ee56b-120">More information about DbProviderFactory can be found in the [MSDN documentation for ADO.NET](https://msdn.microsoft.com/library/a6cd7c08.aspx).</span></span>

### <a name="dbproviderservices"></a><span data-ttu-id="ee56b-121">DbProviderServices</span><span class="sxs-lookup"><span data-stu-id="ee56b-121">DbProviderServices</span></span>

<span data-ttu-id="ee56b-122">EF wird, hängt davon ab, dass DbProviderServices abgeleitet sind, für die Bereitstellung von zusätzliche Funktionen, die von EF auf die bereits von der ADO NET-Anbieter bereitgestellte Funktionalität benötigt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-122">EF depends on having a type derived from DbProviderServices for providing additional functionality needed by EF on top of the functionality already provided by the ADO.NET provider.</span></span> <span data-ttu-id="ee56b-123">In früheren Versionen von EF die DbProviderServices-Klasse Teil von .NET Framework war und in den System.Data.Common-Namespace gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="ee56b-123">In older versions of EF the DbProviderServices class was part of the .NET Framework and was found in the System.Data.Common namespace.</span></span> <span data-ttu-id="ee56b-124">Ab EF6 diese Klasse ist jetzt Teil von EntityFramework.dll und befindet sich im Namespace System.Data.Entity.Core.Common.</span><span class="sxs-lookup"><span data-stu-id="ee56b-124">Starting with EF6 this class is now part of EntityFramework.dll and is in the System.Data.Entity.Core.Common namespace.</span></span>

<span data-ttu-id="ee56b-125">Weitere Informationen zu grundlegenden Funktionen einer DbProviderServices-Implementierung finden Sie auf [MSDN](https://msdn.microsoft.com/library/ee789835.aspx).</span><span class="sxs-lookup"><span data-stu-id="ee56b-125">More details about the fundamental functionality of a DbProviderServices implementation can be found on [MSDN](https://msdn.microsoft.com/library/ee789835.aspx).</span></span> <span data-ttu-id="ee56b-126">Beachten Sie jedoch, dass zum Zeitpunkt der Erstellung des Schreibens von diese Informationen nicht für EF6 aktualisiert wird, obwohl die meisten Konzepte noch gültig sind.</span><span class="sxs-lookup"><span data-stu-id="ee56b-126">However, note that as of the time of writing this information is not updated for EF6 although most of the concepts are still valid.</span></span> <span data-ttu-id="ee56b-127">Die SQL Server und SQL Server Compact-Implementierungen der DbProviderServices werden auch in überprüft, um die [Open-Source-Codebasis](https://github.com/aspnet/EntityFramework6/) und dienen als nützliche Verweise bei anderen Implementierungen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-127">The SQL Server and SQL Server Compact implementations of DbProviderServices are also checked into to the [open-source codebase](https://github.com/aspnet/EntityFramework6/) and can serve as useful references for other implementations.</span></span>

<span data-ttu-id="ee56b-128">In früheren Versionen von EF wurde die DbProviderServices-Implementierung zu verwenden, direkt einem ADO.NET-Anbieter abgerufen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-128">In older versions of EF the DbProviderServices implementation to use was obtained directly from an ADO.NET provider.</span></span> <span data-ttu-id="ee56b-129">Dies erfolgte durch Umwandeln der "DbProviderFactory" in IServiceProvider umwandeln und Aufrufen der GetService-Methode.</span><span class="sxs-lookup"><span data-stu-id="ee56b-129">This was done by casting DbProviderFactory to IServiceProvider and calling the GetService method.</span></span> <span data-ttu-id="ee56b-130">Eng gekoppelter dies den EF-Anbieter, der "DbProviderFactory".</span><span class="sxs-lookup"><span data-stu-id="ee56b-130">This tightly coupled the EF provider to the DbProviderFactory.</span></span> <span data-ttu-id="ee56b-131">Diese Kopplung wird blockiert, dass EF aus .NET Framework verschoben werden und daher für EF6 diese enge Kopplung wurde entfernt und eine Implementierung von DbProviderServices ist nun registriert, direkt in der Konfigurationsdatei der Anwendung oder in Code-basierten Konfiguration, wie im Detail beschrieben die _registrieren DbProviderServices_ Abschnitt weiter unten.</span><span class="sxs-lookup"><span data-stu-id="ee56b-131">This coupling blocked EF from being moved out of the .NET Framework and therefore for EF6 this tight coupling has been removed and an implementation of DbProviderServices is now registered directly in the application’s configuration file or in code-based configuration as described in more detail the _Registering DbProviderServices_ section below.</span></span>

## <a name="additional-services"></a><span data-ttu-id="ee56b-132">Zusätzliche Dienste</span><span class="sxs-lookup"><span data-stu-id="ee56b-132">Additional services</span></span>

<span data-ttu-id="ee56b-133">Zusätzlich zu den grundlegenden Dienste, die oben beschriebenen es gibt auch viele andere Dienste, die von EF verwendet die anbieterspezifische entweder ständig oder gelegentlich sind.</span><span class="sxs-lookup"><span data-stu-id="ee56b-133">In addition to the fundamental services described above there are also many other services used by EF which are either always or sometimes provider-specific.</span></span> <span data-ttu-id="ee56b-134">Anbieterspezifische standardimplementierungen dieser Dienste können durch eine DbProviderServices-Implementierung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-134">Default provider-specific implementations of these services can be supplied by a DbProviderServices implementation.</span></span> <span data-ttu-id="ee56b-135">Anwendungen können auch die Implementierungen dieser Dienste zu überschreiben, oder Implementierungen bereitstellen, wenn ein DbProviderServices keinen Standardwert bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-135">Applications can also override the implementations of these services, or provide implementations when a DbProviderServices type does not provide a default.</span></span> <span data-ttu-id="ee56b-136">Dies wird ausführlicher beschrieben die _zum Auflösen von zusätzlichen Diensten_ Abschnitt weiter unten.</span><span class="sxs-lookup"><span data-stu-id="ee56b-136">This is described in more detail in the _Resolving additional services_ section below.</span></span>

<span data-ttu-id="ee56b-137">Die zusätzliche Diensttypen, die ein Anbieter für einen Anbieter von Interesse sein können, sind unten aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-137">The additional service types that a provider may be of interest to a provider are listed below.</span></span> <span data-ttu-id="ee56b-138">Weitere Informationen über jeden dieser Diensttypen finden Sie in der API-Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="ee56b-138">More details about each of these service types can be found in the API documentation.</span></span>

### <a name="idbexecutionstrategy"></a><span data-ttu-id="ee56b-139">IDbExecutionStrategy</span><span class="sxs-lookup"><span data-stu-id="ee56b-139">IDbExecutionStrategy</span></span>

<span data-ttu-id="ee56b-140">Dies ist ein optionaler Dienst, der ermöglicht, dass einen Anbieter Wiederholungen oder anderem Verhalten implementieren, wenn Abfragen und Befehlen für die Datenbank ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-140">This is an optional service that allows a provider to implement retries or other behavior when queries and commands are executed against the database.</span></span> <span data-ttu-id="ee56b-141">Wenn keine Implementierung bereitgestellt wird, wird Klicken Sie dann EF einfach führen Sie die Befehle und weitergegeben werden alle ausgelösten Ausnahmen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-141">If no implementation is provided, then EF will simply execute the commands and propagate any exceptions thrown.</span></span> <span data-ttu-id="ee56b-142">Für SQL Server ist dieser Dienst verwendet, um eine wiederholungsrichtlinie bereitzustellen, die was besonders hilfreich ist, bei der Ausführung für Cloud-basierten Datenbankserver, z. B. SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="ee56b-142">For SQL Server this service is used to provide a retry policy which is especially useful when running against cloud-based database servers such as SQL Azure.</span></span>

### <a name="idbconnectionfactory"></a><span data-ttu-id="ee56b-143">IDbConnectionFactory</span><span class="sxs-lookup"><span data-stu-id="ee56b-143">IDbConnectionFactory</span></span>

<span data-ttu-id="ee56b-144">Dies ist ein optionaler Dienst, der einen Anbieter zum Erstellen von "DbConnection"-Objekten gemäß der Konvention, wenn nur der Name einer Datenbank ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="ee56b-144">This is an optional service that allows a provider to create DbConnection objects by convention when given only a database name.</span></span> <span data-ttu-id="ee56b-145">Beachten Sie, dass dieser Dienst von einem DbProviderServices-Implementierung aufgelöst werden kann, die es wurde seit EF 4.1 vorhanden und kann auch explizit festgelegt werden in der Config-Datei oder im Code.</span><span class="sxs-lookup"><span data-stu-id="ee56b-145">Note that while this service can be resolved by a DbProviderServices implementation it has been present since EF 4.1 and can also be explicitly set in either the config file or in code.</span></span> <span data-ttu-id="ee56b-146">Der Anbieter erhalten nur die Möglichkeit, diesen Dienst zu beheben, wenn es als Standardanbieter registriert (finden Sie unter _der Standardanbieter_ unten) und eine standardverbindungsfactory nicht an anderer Stelle festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee56b-146">The provider will only get a chance to resolve this service if it registered as the default provider (see _The default provider_ below) and if a default connection factory has not been set elsewhere.</span></span>

### <a name="dbspatialservices"></a><span data-ttu-id="ee56b-147">DbSpatialServices</span><span class="sxs-lookup"><span data-stu-id="ee56b-147">DbSpatialServices</span></span>

<span data-ttu-id="ee56b-148">Dies ist eine optionale Dienste, die einen Anbieter zum Hinzufügen der Unterstützung für Geography und Geometry räumliche Typen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="ee56b-148">This is an optional services that allows a provider to add support for geography and geometry spatial types.</span></span> <span data-ttu-id="ee56b-149">Eine Implementierung dieses Diensts muss in der Reihenfolge für eine Anwendung für die Verwendung von EF mit räumlichen Typen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-149">An implementation of this service must be supplied in order for an application to use EF with spatial types.</span></span> <span data-ttu-id="ee56b-150">DbSptialServices wird auf zwei Arten zur aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="ee56b-150">DbSptialServices is asked for in two ways.</span></span> <span data-ttu-id="ee56b-151">Erste, anbieterspezifische räumlichen Dienste mithilfe eines Objekts DbProviderInfo angefordert werden (die invariante enthält Namen und das manifesttoken) als Schlüssel.</span><span class="sxs-lookup"><span data-stu-id="ee56b-151">First, provider-specific spatial services are requested using a DbProviderInfo object (which contains invariant name and manifest token) as key.</span></span> <span data-ttu-id="ee56b-152">Zweitens können DbSpatialServices ohne Schlüssel aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="ee56b-152">Second, DbSpatialServices can be asked for with no key.</span></span> <span data-ttu-id="ee56b-153">Dies wird zum Auflösen der "räumlichen Anbieter", die beim Erstellen von eigenständigen DbGeography oder DbGeometry-Typen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-153">This is used to resolve the “global spatial provider” that is used when creating stand-alone DbGeography or DbGeometry types.</span></span>

### <a name="migrationsqlgenerator"></a><span data-ttu-id="ee56b-154">MigrationSqlGenerator</span><span class="sxs-lookup"><span data-stu-id="ee56b-154">MigrationSqlGenerator</span></span>

<span data-ttu-id="ee56b-155">Dies ist ein optionaler Dienst, mit dem EF-Migrationen durch Code First zum Generieren von SQL zum Erstellen und Ändern von Datenbankschemas verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="ee56b-155">This is an optional service that allows EF Migrations to be used for the generation of SQL used in creating and modifying database schemas by Code First.</span></span> <span data-ttu-id="ee56b-156">Eine Implementierung ist erforderlich, um Migrationen zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-156">An implementation is required in order to support Migrations.</span></span> <span data-ttu-id="ee56b-157">Wenn eine Implementierung bereitgestellt wird wird Klicken Sie dann es auch verwendet werden, wenn Datenbanken mit Datenbankinitialisierer oder der Database.Create-Methode erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-157">If an implementation is provided then it will also be used when databases are created using database initializers or the Database.Create method.</span></span>

### <a name="funcdbconnection-string-historycontextfactory"></a><span data-ttu-id="ee56b-158">Func<DbConnection, string, HistoryContextFactory></span><span class="sxs-lookup"><span data-stu-id="ee56b-158">Func<DbConnection, string, HistoryContextFactory></span></span>

<span data-ttu-id="ee56b-159">Dies ist ein optionaler Dienst, der einen Anbieter so konfigurieren Sie die "historycontext" für die Zuordnung ermöglicht die `__MigrationHistory` Tabelle, die von EF-Migrationen verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-159">This is an optional service that allows a provider to configure the mapping of the HistoryContext to the `__MigrationHistory` table used by EF Migrations.</span></span> <span data-ttu-id="ee56b-160">Die "historycontext" ist der Code für einen ersten "DbContext" und kann mithilfe der normalen fluent-API so ändern Sie z.B. den Namen der Tabelle und den Mappingspezifikationen Spalte konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-160">The HistoryContext is a Code First DbContext and can be configured using the normal fluent API to change things like the name of the table and the column mapping specifications.</span></span> <span data-ttu-id="ee56b-161">Die standardmäßige Implementierung des Diensts zurückgegeben, die von EF für alle Anbieter funktioniert möglicherweise für eine bestimmte Datenbank-Server, wenn alle die Tabelle und Spalte standardzuordnungen von diesem Anbieter unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-161">The default implementation of this service returned by EF for all providers may work for a given database server if all the default table and column mappings are supported by that provider.</span></span> <span data-ttu-id="ee56b-162">In diesem Fall muss der Anbieter nicht auf eine Implementierung dieses Diensts bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-162">In such a case the provider does not need to supply an implementation of this service.</span></span>

### <a name="idbproviderfactoryresolver"></a><span data-ttu-id="ee56b-163">IDbProviderFactoryResolver</span><span class="sxs-lookup"><span data-stu-id="ee56b-163">IDbProviderFactoryResolver</span></span>

<span data-ttu-id="ee56b-164">Dies ist ein optionaler Dienst zum Abrufen der richtigen "DbProviderFactory" aus einem angegebenen DbConnection-Objekt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-164">This is an optional service for obtaining the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="ee56b-165">Die standardmäßige Implementierung des Diensts, die für alle Anbieter von EF zurückgegeben soll für alle Anbieter funktionieren.</span><span class="sxs-lookup"><span data-stu-id="ee56b-165">The default implementation of this service returned by EF for all providers is intended to work for all providers.</span></span> <span data-ttu-id="ee56b-166">Bei der Ausführung in .NET 4 der "DbProviderFactory" ist jedoch nicht über einen öffentlich zugänglichen seine DbConnections.</span><span class="sxs-lookup"><span data-stu-id="ee56b-166">However, when running on .NET 4, the DbProviderFactory is not publicly accessible from one if its DbConnections.</span></span> <span data-ttu-id="ee56b-167">Aus diesem Grund verwendet EF Teil der Heuristik, um die registrierten Anbieter um eine Übereinstimmung zu finden. zu durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-167">Therefore, EF uses some heuristics to search the registered providers to find a match.</span></span> <span data-ttu-id="ee56b-168">Es ist möglich, dass für einige Anbieter diese Heuristiken fehl, und in solchen Situationen sollte der Anbieter eine neue Implementierung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-168">It is possible that for some providers these heuristics will fail and in such situations the provider should supply a new implementation.</span></span>

## <a name="registering-dbproviderservices"></a><span data-ttu-id="ee56b-169">Registrieren von DbProviderServices</span><span class="sxs-lookup"><span data-stu-id="ee56b-169">Registering DbProviderServices</span></span>

<span data-ttu-id="ee56b-170">Die DbProviderServices-Implementierung verwenden kann entweder in der Anwendung ("App.config" oder "Web.config") oder über die codebasierte Konfiguration registriert werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-170">The DbProviderServices implementation to use can be registered either in the application’s configuration file (app.config or web.config) or using code-based configuration.</span></span> <span data-ttu-id="ee56b-171">In beiden Fällen wird durch die Registrierung des Anbieters "invarianten Namen" als Schlüssel verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-171">In either case the registration uses the provider’s “invariant name” as a key.</span></span> <span data-ttu-id="ee56b-172">Dadurch können mehrere Anbieter registriert und in einer einzelnen Anwendung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-172">This allows multiple providers to be registered and used in a single application.</span></span> <span data-ttu-id="ee56b-173">Der invariante Name des EF-Registrierungen zum ist identisch mit der invariante Name des für die Registrierung und verbindungsherstellung anbieterzeichenfolgen des ADO.NET verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-173">The invariant name used for EF registrations is the same as the invariant name used for ADO.NET provider registration and connection strings.</span></span> <span data-ttu-id="ee56b-174">Beispielsweise wird für SQL Server den invarianten Namen "System.Data.SqlClient" verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-174">For example, for SQL Server the invariant name “System.Data.SqlClient” is used.</span></span>

### <a name="config-file-registration"></a><span data-ttu-id="ee56b-175">Registrierung über die Konfigurationsdatei</span><span class="sxs-lookup"><span data-stu-id="ee56b-175">Config file registration</span></span>

<span data-ttu-id="ee56b-176">Der zu verwendende DbProviderServices-Typ wird als ein Anbieterelement in der Anbieterliste der EntityFramework-Abschnitt der Konfigurationsdatei der Anwendung registriert.</span><span class="sxs-lookup"><span data-stu-id="ee56b-176">The DbProviderServices type to use is registered as a provider element in the providers list of the entityFramework section of the application’s config file.</span></span> <span data-ttu-id="ee56b-177">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="ee56b-177">For example:</span></span>

``` xml
<entityFramework>
  <providers>
    <provider invariantName="My.Invariant.Name" type="MyProvider.MyProviderServices, MyAssembly" />
  </providers>
</entityFramework>
```

<span data-ttu-id="ee56b-178">Die _Typ_ Zeichenfolge muss die Assembly qualifizierten Typnamen der DbProviderServices-Implementierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-178">The _type_ string must be the assembly-qualified type name of the DbProviderServices implementation to use.</span></span>

### <a name="code-based-registration"></a><span data-ttu-id="ee56b-179">Codebasierte Registrierung</span><span class="sxs-lookup"><span data-stu-id="ee56b-179">Code-based registration</span></span>

<span data-ttu-id="ee56b-180">Beginnend mit der EF6-Anbieter kann auch registriert werden mithilfe von Code.</span><span class="sxs-lookup"><span data-stu-id="ee56b-180">Starting with EF6 providers can also be registered using code.</span></span> <span data-ttu-id="ee56b-181">Dies ermöglicht einen EF-Anbieter, ohne jede Änderung an der Konfigurationsdatei der Anwendung verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="ee56b-181">This allows an EF provider to be used without any change to the application’s configuration file.</span></span> <span data-ttu-id="ee56b-182">Codebasierte Konfiguration verwenden sollte eine Anwendung eine "dbconfiguration"-Klasse erstellen, wie beschrieben in der [codebasierte Konfigurationsdokumentation](https://msdn.com/data/jj680699).</span><span class="sxs-lookup"><span data-stu-id="ee56b-182">To use code-based configuration an application should create a DbConfiguration class as described in the [code-based configuration documentation](https://msdn.com/data/jj680699).</span></span> <span data-ttu-id="ee56b-183">Der Konstruktor der Klasse "dbconfiguration" sollten SetProviderServices zum Registrieren des EF-Anbieters aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-183">The constructor of the DbConfiguration class should then call SetProviderServices to register the EF provider.</span></span> <span data-ttu-id="ee56b-184">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="ee56b-184">For example:</span></span>

``` csharp
public class MyConfiguration : DbConfiguration
{
    public MyConfiguration()
    {
        SetProviderServices("My.New.Provider", new MyProviderServices());
    }
}
```

## <a name="resolving-additional-services"></a><span data-ttu-id="ee56b-185">Zum Auflösen von zusätzlichen Diensten</span><span class="sxs-lookup"><span data-stu-id="ee56b-185">Resolving additional services</span></span>

<span data-ttu-id="ee56b-186">Wie bereits erwähnt in der _Anbieter Typen – Übersicht_ Abschnitt eine DbProviderServices Klasse kann auch verwendet werden, um zusätzliche Dienste aufzulösen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-186">As mentioned above in the _Provider types overview_ section, a DbProviderServices class can also be used to resolve additional services.</span></span> <span data-ttu-id="ee56b-187">Dies ist möglich, da DbProviderServices "idbdependencyresolver implementiert", und jede registrierter DbProviderServices-Typ wird als ein "standardmäßiger Resolver" hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-187">This is possible because DbProviderServices implements IDbDependencyResolver and each registered DbProviderServices type is added as a “default resolver”.</span></span> <span data-ttu-id="ee56b-188">Die IDbDpendencyResolver-Mechanismus wird ausführlicher beschrieben [Abhängigkeitsauflösung](~/ef6/fundamentals/configuring/dependency-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="ee56b-188">The IDbDpendencyResolver mechanism is described in more detail in [Dependency Resolution](~/ef6/fundamentals/configuring/dependency-resolution.md).</span></span> <span data-ttu-id="ee56b-189">Jedoch ist es nicht erforderlich, um alle Konzepte in dieser Spezifikation zum Auflösen von zusätzlicher Diensten in einem Anbieter zu verstehen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-189">However, it is not necessary to understand all the concepts in this specification to resolve additional services in a provider.</span></span>

<span data-ttu-id="ee56b-190">Die gängigste Methode für einen Anbieter zum Auflösen von zusätzlicher Diensten wird DbProviderServices.AddDependencyResolver für jeden Dienst in den Konstruktor der Klasse DbProviderServices aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-190">The most common way for a provider to resolve additional services is to call DbProviderServices.AddDependencyResolver for each service in the constructor of the DbProviderServices class.</span></span> <span data-ttu-id="ee56b-191">SqlProviderServices (der EF-Anbieter für SQL Server) hat beispielsweise Code wie diesen für die Initialisierung:</span><span class="sxs-lookup"><span data-stu-id="ee56b-191">For example, SqlProviderServices (the EF provider for SQL Server) has code similar to this for initialization:</span></span>

``` csharp
private SqlProviderServices()
{
    AddDependencyResolver(new SingletonDependencyResolver<IDbConnectionFactory>(
        new SqlConnectionFactory()));

    AddDependencyResolver(new ExecutionStrategyResolver<DefaultSqlExecutionStrategy>(
        "System.data.SqlClient", null, () => new DefaultSqlExecutionStrategy()));

    AddDependencyResolver(new SingletonDependencyResolver<Func<MigrationSqlGenerator>>(
        () => new SqlServerMigrationSqlGenerator(), "System.data.SqlClient"));

    AddDependencyResolver(new SingletonDependencyResolver<DbSpatialServices>(
        SqlSpatialServices.Instance,
        k =>
        {
            var asSpatialKey = k as DbProviderInfo;
            return asSpatialKey == null
                || asSpatialKey.ProviderInvariantName == ProviderInvariantName;
        }));
}
```

<span data-ttu-id="ee56b-192">Dieser Konstruktor verwendet die folgenden Hilfsklassen:</span><span class="sxs-lookup"><span data-stu-id="ee56b-192">This constructor uses the following helper classes:</span></span>

*   <span data-ttu-id="ee56b-193">SingletonDependencyResolver: bietet eine einfache Möglichkeit zum Auflösen der Singleton-Dienste –, also Dienste, die für die die gleiche Instanz zurückgegeben jedes Mal, dass "GetService" aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-193">SingletonDependencyResolver: provides a simple way to resolve Singleton services—that is, services for which the same instance is returned each time that GetService is called.</span></span> <span data-ttu-id="ee56b-194">Kurzlebige Dienste werden häufig als eine Singletonfactory registriert, die zum Erstellen temporärer Instanzen bei Bedarf verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-194">Transient services are often registered as a singleton factory that will be used to create transient instances on demand.</span></span>
*   <span data-ttu-id="ee56b-195">ExecutionStrategyResolver: ein Resolver für IExecutionStrategy Implementierungen zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ee56b-195">ExecutionStrategyResolver: a resolver specific to returning IExecutionStrategy implementations.</span></span>

<span data-ttu-id="ee56b-196">Anstelle von DbProviderServices.AddDependencyResolver ist es auch möglich, außer Kraft setzen DbProviderServices.GetService und zusätzliche Dienste direkt zu beheben.</span><span class="sxs-lookup"><span data-stu-id="ee56b-196">Instead of using DbProviderServices.AddDependencyResolver it is also possible to override DbProviderServices.GetService and resolve additional services directly.</span></span> <span data-ttu-id="ee56b-197">Diese Methode wird aufgerufen werden, wenn EF ein Dienst, der definiert, von einem bestimmten Typ und in einigen Fällen für einen bestimmten Schlüssel benötigt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-197">This method will be called when EF needs a service defined by a certain type and, in some cases, for a given key.</span></span> <span data-ttu-id="ee56b-198">Die Methode muss der Dienst zurückgeben, wenn kann, oder null zurückgeben, um die Rückgabe des Diensts teilnehmen und eine andere Klasse zur Behebung lassen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-198">The method should return the service if it can, or return null to opt-out of returning the service and instead allow another class to resolve it.</span></span> <span data-ttu-id="ee56b-199">Beispielsweise kann die standardverbindungsfactory der Behebung der Code in "GetService" wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="ee56b-199">For example, to resolve the default connection factory the code in GetService might look something like this:</span></span>

``` csharp
public override object GetService(Type type, object key)
{
    if (type == typeof(IDbConnectionFactory))
    {
        return new SqlConnectionFactory();
    }
    return null;
}
```

### <a name="registration-order"></a><span data-ttu-id="ee56b-200">Registrierungsreihenfolge</span><span class="sxs-lookup"><span data-stu-id="ee56b-200">Registration order</span></span>

<span data-ttu-id="ee56b-201">Wenn mehrere DbProviderServices-Implementierungen in der Konfigurationsdatei der Anwendung registriert sind werden sie als sekundären Resolver in der Reihenfolge hinzugefügt werden, dass sie aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="ee56b-201">When multiple DbProviderServices implementations are registered in an application’s config file they will be added as secondary resolvers in the order that they are listed.</span></span> <span data-ttu-id="ee56b-202">Da Konfliktlöser immer am Anfang der Kette sekundären Konfliktlöser, dass dies bedeutet hinzugefügt werden, dass der Anbieter am Ende der Liste zum Auflösen von Abhängigkeiten, bevor Sie die anderen werden wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-202">Since resolvers are always added to the top of the secondary resolver chain this means that the provider at the end of the list will get a chance to resolve dependencies before the others.</span></span> <span data-ttu-id="ee56b-203">(Mag zunächst ein wenig widersinnig, aber es ist sinnvoll, wenn Sie sich vorstellen, nehmen jeder Anbieter aus der Liste, und es zusätzlich zu den vorhandenen Anbietern Stapeln.)</span><span class="sxs-lookup"><span data-stu-id="ee56b-203">(This can seem a little counter-intuitive at first, but it makes sense if you imagine taking each provider out of the list and stacking it on top of the existing providers.)</span></span>

<span data-ttu-id="ee56b-204">Diese Sortierung ist in der Regel unerheblich, da die meisten Anbieterdienste-spezifischen und vom invarianten Anbieternamen schlüsselgebundene sind.</span><span class="sxs-lookup"><span data-stu-id="ee56b-204">This ordering usually doesn’t matter because most provider services are provider-specific and keyed by provider invariant name.</span></span> <span data-ttu-id="ee56b-205">Allerdings werden für Dienste, die nicht nach Argumentnamen geordnet invariante Anbietername oder einige andere anbieterspezifische Schlüssel wird der Dienst nicht aufgelöst werden basierend auf dieser Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="ee56b-205">However, for services that are not keyed by provider invariant name or some other provider-specific key the service will be resolved based on this ordering.</span></span> <span data-ttu-id="ee56b-206">Z. B. Wenn sie nicht explizit anders an einer beliebigen Stelle andernfalls festgelegt ist, ist die standardverbindungsfactory vom obersten Anbieter in der Kette festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-206">For example, if it is not explicitly set differently somewhere else, then the default connection factory will come from the topmost provider in the chain.</span></span>

## <a name="additional-config-file-registrations"></a><span data-ttu-id="ee56b-207">Zusätzliche Config-Datei-Registrierungen</span><span class="sxs-lookup"><span data-stu-id="ee56b-207">Additional config file registrations</span></span>

<span data-ttu-id="ee56b-208">Es ist möglich, einige der oben beschriebenen, direkt in der Konfigurationsdatei der Anwendung zusätzliche Anbieterdienste explizit zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="ee56b-208">It is possible to explicitly register some of the additional provider services described above directly in an application’s config file.</span></span> <span data-ttu-id="ee56b-209">Anschließend wird die Registrierung in der Config-Datei werden keine zurückgegeben, die von der GetService-Methode, der die DbProviderServices-Implementierung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-209">When this is done the registration in the config file will be used instead of anything returned by the GetService method of the DbProviderServices implementation.</span></span>

### <a name="registering-the-default-connection-factory"></a><span data-ttu-id="ee56b-210">Die standardverbindungsfactory registrieren</span><span class="sxs-lookup"><span data-stu-id="ee56b-210">Registering the default connection factory</span></span>

<span data-ttu-id="ee56b-211">Mit EF5 EntityFramework NuGet-Paket automatisch gestartet, werden entweder die verbindungsfactory SQL Express oder der LocalDb-verbindungsfactory in der Konfigurationsdatei registriert.</span><span class="sxs-lookup"><span data-stu-id="ee56b-211">Starting with EF5 the EntityFramework NuGet package automatically registered either the SQL Express connection factory or the LocalDb connection factory in the config file.</span></span>

<span data-ttu-id="ee56b-212">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="ee56b-212">For example:</span></span>

``` xml
<entityFramework>
  <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" >
</entityFramework>
```

<span data-ttu-id="ee56b-213">Die _Typ_ wird die Assembly qualifizierten Typnamen für die standardverbindungsfactory, die IDbConnectionFactory implementieren muss.</span><span class="sxs-lookup"><span data-stu-id="ee56b-213">The _type_ is the assembly-qualified type name for the default connection factory, which must implement IDbConnectionFactory.</span></span>

<span data-ttu-id="ee56b-214">Es wird empfohlen, dass ein Anbieter-NuGet-Paket die standardverbindungsfactory auf diese Weise bei der Installation festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-214">It is recommended that a provider NuGet package set the default connection factory in this way when installed.</span></span> <span data-ttu-id="ee56b-215">Finden Sie unter _NuGet-Pakete für Anbieter_ unten.</span><span class="sxs-lookup"><span data-stu-id="ee56b-215">See _NuGet Packages for providers_ below.</span></span>

## <a name="additional-ef6-provider-changes"></a><span data-ttu-id="ee56b-216">Zusätzliche Änderungen der EF6-Anbieter</span><span class="sxs-lookup"><span data-stu-id="ee56b-216">Additional EF6 provider changes</span></span>

### <a name="spatial-provider-changes"></a><span data-ttu-id="ee56b-217">Räumliche Anbieter-Änderungen</span><span class="sxs-lookup"><span data-stu-id="ee56b-217">Spatial provider changes</span></span>

<span data-ttu-id="ee56b-218">Anbieter, die räumliche Typen zu unterstützen, müssen nun einige zusätzlichen Methoden für abgeleitete Klassen von DbSpatialDataReader implementieren:</span><span class="sxs-lookup"><span data-stu-id="ee56b-218">Providers that support spatial types must now implement some additional methods on classes deriving from DbSpatialDataReader:</span></span>

*   `public abstract bool IsGeographyColumn(int ordinal)`
*   `public abstract bool IsGeometryColumn(int ordinal)`

<span data-ttu-id="ee56b-219">Es gibt auch neue asynchrone Versionen der vorhandenen Methoden, die außer Kraft gesetzt werden, da die standardimplementierungen der synchronen Methoden delegieren und aus diesem Grund nicht asynchron führen sollten:</span><span class="sxs-lookup"><span data-stu-id="ee56b-219">There are also new asynchronous versions of existing methods that are recommended to be overridden as the default implementations delegate to the synchronous methods and therefore do not execute asynchronously:</span></span>

*   `public virtual Task<DbGeography> GetGeographyAsync(int ordinal, CancellationToken cancellationToken)`
*   `public virtual Task<DbGeometry> GetGeometryAsync(int ordinal, CancellationToken cancellationToken)`

### <a name="native-support-for-enumerablecontains"></a><span data-ttu-id="ee56b-220">Systemeigene Unterstützung für Enumerable.Contains</span><span class="sxs-lookup"><span data-stu-id="ee56b-220">Native support for Enumerable.Contains</span></span>

<span data-ttu-id="ee56b-221">EF6 führt es sich um einen neuen Ausdruck ein, DbInExpression, die Leistungsprobleme für die Verwendung der Enumerable.Contains in LINQ-Abfragen hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee56b-221">EF6 introduces a new expression type, DbInExpression, which was added to address performance issues around use of Enumerable.Contains in LINQ queries.</span></span> <span data-ttu-id="ee56b-222">Die DbProviderManifest-Klasse verfügt über eine neue virtuelle Methode SupportsInExpression, die aufgerufen wird, von EF zu bestimmen, ob ein Anbieter den Typ des neuer Ausdrucks verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-222">The DbProviderManifest class has a new virtual method, SupportsInExpression, which is called by EF to determine if a provider handles the new expression type.</span></span> <span data-ttu-id="ee56b-223">Für die Kompatibilität mit vorhandenen Implementierungen für Anbieter gibt die Methode "false" zurück.</span><span class="sxs-lookup"><span data-stu-id="ee56b-223">For compatibility with existing provider implementations the method returns false.</span></span> <span data-ttu-id="ee56b-224">Um diese Verbesserung nutzen, kann ein Anbieter für EF 6 Code hinzufügen, zum Verarbeiten von DbInExpression und außer Kraft setzen SupportsInExpression true zurück.</span><span class="sxs-lookup"><span data-stu-id="ee56b-224">To benefit from this improvement, an EF6 provider can add code to handle DbInExpression and override SupportsInExpression to return true.</span></span> <span data-ttu-id="ee56b-225">Eine Instanz von DbInExpression kann durch Aufrufen der Methode DbExpressionBuilder.In erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-225">An instance of DbInExpression can be created by calling the DbExpressionBuilder.In method.</span></span> <span data-ttu-id="ee56b-226">Eine Instanz DbInExpression besteht ein "DbExpression", in der Regel eine Spalte und eine Liste der DbConstantExpression auf Übereinstimmung zu prüfende darstellt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-226">A DbInExpression instance is composed of a DbExpression, usually representing a table column, and a list of DbConstantExpression to test for a match.</span></span>

## <a name="nuget-packages-for-providers"></a><span data-ttu-id="ee56b-227">NuGet-Pakete für Anbieter</span><span class="sxs-lookup"><span data-stu-id="ee56b-227">NuGet packages for providers</span></span>

<span data-ttu-id="ee56b-228">Eine Möglichkeit, einen Anbieter für EF 6 verfügbar machen werden als NuGet-Paket freigeben.</span><span class="sxs-lookup"><span data-stu-id="ee56b-228">One way to make an EF6 provider available is to release it as a NuGet package.</span></span> <span data-ttu-id="ee56b-229">Verwenden ein NuGet-Paket bietet folgende Vorteile:</span><span class="sxs-lookup"><span data-stu-id="ee56b-229">Using a NuGet package has the following advantages:</span></span>

*   <span data-ttu-id="ee56b-230">Es ist einfach zu verwenden NuGet Config-Datei der Anwendung die Registrierung des Anbieters hinzu</span><span class="sxs-lookup"><span data-stu-id="ee56b-230">It is easy to use NuGet to add the provider registration to the application’s config file</span></span>
*   <span data-ttu-id="ee56b-231">Weitere Änderungen können an der Config-Datei vorgenommen werden, die standardverbindungsfactory so festlegen, dass Verbindungen, die gemäß der Konvention das registrierte Anbieter verwenden</span><span class="sxs-lookup"><span data-stu-id="ee56b-231">Additional changes can be made to the config file to set the default connection factory so that connections made by convention will use the registered provider</span></span>
*   <span data-ttu-id="ee56b-232">NuGet behandelt bindungsumleitungen hinzufügen, damit an, dass der EF6-Anbieter weiterhin funktionieren, auch nach der Veröffentlichung eines neuen EF-Pakets sollte</span><span class="sxs-lookup"><span data-stu-id="ee56b-232">NuGet handles adding binding redirects so that the EF6 provider should continue to work even after a new EF package is released</span></span>

<span data-ttu-id="ee56b-233">Ein Beispiel hierfür ist das EntityFramework.SqlServerCompact-Paket der in enthalten ist das [open-Source-Codebasis](http://github.com/aspnet/entityframework6).</span><span class="sxs-lookup"><span data-stu-id="ee56b-233">An example of this is the EntityFramework.SqlServerCompact package which is included in the [open source codebase](http://github.com/aspnet/entityframework6).</span></span> <span data-ttu-id="ee56b-234">Dieses Paket enthält eine gute Vorlage zum Erstellen von NuGet-Pakete für die EF-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="ee56b-234">This package provides a good template for creating EF provider NuGet packages.</span></span>

### <a name="powershell-commands"></a><span data-ttu-id="ee56b-235">PowerShell-Befehle</span><span class="sxs-lookup"><span data-stu-id="ee56b-235">PowerShell commands</span></span>

<span data-ttu-id="ee56b-236">Wenn EntityFramework NuGet-Paket installiert wird, registriert sie ein PowerShell-Modul, das zwei Befehle enthält, die für die anbieterpakete sehr nützlich sind:</span><span class="sxs-lookup"><span data-stu-id="ee56b-236">When the EntityFramework NuGet package is installed it registers a PowerShell module that contains two commands that are very useful for provider packages:</span></span>

*   <span data-ttu-id="ee56b-237">Hinzufügen EFProvider Fügt eine neue Entität, für den Anbieter in der Konfigurationsdatei für das Zielprojekt und stellt sicher, dass es am Ende der Liste der registrierten Anbieter ist.</span><span class="sxs-lookup"><span data-stu-id="ee56b-237">Add-EFProvider adds a new entity for the provider in the target project’s configuration file and makes sure it is at the end of the list of registered providers.</span></span>
*   <span data-ttu-id="ee56b-238">Hinzufügen EFDefaultConnectionFactory entweder hinzugefügt oder aktualisiert die DefaultConnectionFactory-Registrierung in das Zielprojekt-Konfigurationsdatei.</span><span class="sxs-lookup"><span data-stu-id="ee56b-238">Add-EFDefaultConnectionFactory either adds or updates the defaultConnectionFactory registration in the target project’s configuration file.</span></span>

<span data-ttu-id="ee56b-239">Diese beiden Befehle übernehmen einen EntityFramework-Abschnitt der Config-Datei hinzufügen und eine Sammlung der Anbieter hinzufügen, falls erforderlich.</span><span class="sxs-lookup"><span data-stu-id="ee56b-239">Both these commands take care of adding an entityFramework section to the config file and adding a providers collection if necessary.</span></span>

<span data-ttu-id="ee56b-240">Es ist vorgesehen, dass diese Befehle aus dem NuGet-Skript Install. ps1 aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-240">It is intended that these commands be called from the install.ps1 NuGet script.</span></span> <span data-ttu-id="ee56b-241">Beispielsweise sieht Install. ps1 für den SQL Compact-Anbieter wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="ee56b-241">For example, install.ps1 for the SQL Compact provider looks similar to this:</span></span>

``` powershell
param($installPath, $toolsPath, $package, $project)
Add-EFDefaultConnectionFactory $project 'System.Data.Entity.Infrastructure.SqlCeConnectionFactory, EntityFramework' -ConstructorArguments 'System.Data.SqlServerCe.4.0'
Add-EFProvider $project 'System.Data.SqlServerCe.4.0' 'System.Data.Entity.SqlServerCompact.SqlCeProviderServices, EntityFramework.SqlServerCompact'</pre>
```

<span data-ttu-id="ee56b-242">Weitere Informationen zu diesen Befehlen kann mithilfe von Get-Help im Fenster Paket-Manager-Konsole abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-242">More information about these commands can be obtained by using get-help in the Package Manager Console window.</span></span>

## <a name="wrapping-providers"></a><span data-ttu-id="ee56b-243">Umschließen von Anbietern</span><span class="sxs-lookup"><span data-stu-id="ee56b-243">Wrapping providers</span></span>

<span data-ttu-id="ee56b-244">Ein Umbruch-Anbieter ist ein EF und/oder ADO.NET-Anbieter, der einen vorhandenen Anbieter so erweitern, mit anderen Funktionen wie z. B. die profilerstellung oder Ablaufverfolgungsfunktionen umschließt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-244">A wrapping provider is an EF and/or ADO.NET provider that wraps an existing provider to extend it with other functionality such as profiling or tracing capabilities.</span></span> <span data-ttu-id="ee56b-245">Umschließen die Anbieter auf die übliche Weise registriert werden kann, aber häufig ist es sinnvoll, den Anbieter "Wrapping" zur Laufzeit durch Abfangen der Auflösung des Anbieter-bezogene Dienste einrichten.</span><span class="sxs-lookup"><span data-stu-id="ee56b-245">Wrapping providers can be registered in the normal way, but it is often more convenient to setup the wrapping provider at runtime by intercepting the resolution of provider-related services.</span></span> <span data-ttu-id="ee56b-246">Das statische Ereignis OnLockingConfiguration für die DbConfiguration-Klasse kann dazu verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-246">The static event OnLockingConfiguration on the DbConfiguration class can be used to do this.</span></span>

<span data-ttu-id="ee56b-247">OnLockingConfiguration wird aufgerufen, nachdem EF ermittelt hat, in dem die gesamte EF-Konfiguration für die Anwendungsdomäne von erhalten wird, aber bevor es für die Verwendung gesperrt wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-247">OnLockingConfiguration is called after EF has determined where all EF configuration for the app domain will be obtained from but before it is locked for use.</span></span> <span data-ttu-id="ee56b-248">Beim Starten der app (bevor EF verwendet wird), sollten die app einen Ereignishandler für dieses Ereignis registrieren.</span><span class="sxs-lookup"><span data-stu-id="ee56b-248">At app startup (before EF is used) the app should register an event handler for this event.</span></span> <span data-ttu-id="ee56b-249">(Wird derzeit die Unterstützung für die Registrierung dieser Handler in der Konfigurationsdatei hinzufügen, aber dies ist noch nicht unterstützt.) Der Ereignishandler muss dann ReplaceService für jeden Dienst aufrufen, die eingeschlossen werden muss.</span><span class="sxs-lookup"><span data-stu-id="ee56b-249">(We are considering adding support for registering this handler in the config file but this is not yet supported.) The event handler should then make a call to ReplaceService for every service that needs to be wrapped.</span></span>  

<span data-ttu-id="ee56b-250">Beispielsweise sollte ein Handler könnte folgendermaßen aussehen IDbConnectionFactory und DbProviderService Wrapper, registriert werden:</span><span class="sxs-lookup"><span data-stu-id="ee56b-250">For example, to wrap IDbConnectionFactory and DbProviderService, a handler something like this should be registered:</span></span>

``` csharp
DbConfiguration.OnLockingConfiguration +=
    (_, a) =>
    {
        a.ReplaceService<DbProviderServices>(
            (s, k) => new MyWrappedProviderServices(s));

        a.ReplaceService<IDbConnectionFactory>(
            (s, k) => new MyWrappedConnectionFactory(s));
    };
```

<span data-ttu-id="ee56b-251">Der Dienst, der wurde behoben und nun zusammen mit den Schlüssel, der mit den Dienst aufgelöst wurde umschlossen werden, an den Handler übergeben.</span><span class="sxs-lookup"><span data-stu-id="ee56b-251">The service that has been resolved and should now be wrapped together with the key that was used to resolve the service are passed to the handler.</span></span> <span data-ttu-id="ee56b-252">Der Handler kann dann umschließen diesen Dienst und den zurückgegebenen Dienst durch die umschlossene Version ersetzen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-252">The handler can then wrap this service and replace the returned service with the wrapped version.</span></span>

## <a name="resolving-a-dbproviderfactory-with-ef"></a><span data-ttu-id="ee56b-253">Auflösen von einer "DbProviderFactory" in EF</span><span class="sxs-lookup"><span data-stu-id="ee56b-253">Resolving a DbProviderFactory with EF</span></span>

<span data-ttu-id="ee56b-254">"DbProviderFactory" ist eines der grundlegenden Anbietertypen von EF benötigt werden, wie beschrieben in der _Anbieter Typen – Übersicht_ weiter oben.</span><span class="sxs-lookup"><span data-stu-id="ee56b-254">DbProviderFactory is one of the fundamental provider types needed by EF as described in the _Provider types overview_ section above.</span></span> <span data-ttu-id="ee56b-255">Wie bereits erwähnt, kann kein EF-Typ und Registrierung ist in der Regel nicht Teil der EF-Konfiguration, aber es wird stattdessen der normale ADO.NET anbieterregistrierung in der Datei "Machine.config" und/oder der Konfigurationsdatei der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ee56b-255">As already mentioned, It is not an EF type and registration is usually not part of EF configuration, but is instead the normal ADO.NET provider registration in the machine.config file and/or application’s config file.</span></span>

<span data-ttu-id="ee56b-256">Trotz dieser EF verwendet immer noch der Standardmechanismus für die normale Abhängigkeit bei der Suche nach einer "DbProviderFactory" verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-256">Despite this EF still uses its normal dependency resolution mechanism when looking for a DbProviderFactory to use.</span></span> <span data-ttu-id="ee56b-257">Der Standardresolver verwendet die normale Registrierung für ADO.NET in die Konfigurationsdateien und in der Regel transparent ist.</span><span class="sxs-lookup"><span data-stu-id="ee56b-257">The default resolver uses the normal ADO.NET registration in the config files and so this is usually transparent.</span></span> <span data-ttu-id="ee56b-258">Aufgrund der normalen abhängigkeitsauflösung Mechanismus verwendet wird, aber dies bedeutet, dass eine "idbdependencyresolver" verwendet werden kann, um einer "DbProviderFactory" zu beheben, selbst wenn die normalen ADO.NET-Registrierung nicht ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="ee56b-258">But because of the normal dependency resolution mechanism is used it means that an IDbDependencyResolver can be used to resolve a DbProviderFactory even when normal ADO.NET registration has not been done.</span></span>

<span data-ttu-id="ee56b-259">Auflösung von DbProviderFactory. auf diese Weise hat mehrere Auswirkungen:</span><span class="sxs-lookup"><span data-stu-id="ee56b-259">Resolving DbProviderFactory in this way has several implications:</span></span>

*   <span data-ttu-id="ee56b-260">Eine Anwendung mit codebasierte Konfiguration kann Aufrufe in die DbConfiguration-Klasse, zum Registrieren der entsprechenden "DbProviderFactory" hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-260">An application using code-based configuration can add calls in their DbConfiguration class to register the appropriate DbProviderFactory.</span></span> <span data-ttu-id="ee56b-261">Dies ist besonders nützlich für Anwendungen, die nicht möchten (oder nicht) stellen eine dateibasierte Konfiguration zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-261">This is especially useful for applications that do not want to (or cannot) make use of any file-based configuration at all.</span></span>
*   <span data-ttu-id="ee56b-262">Der Dienst kann eingebunden werden oder mithilfe von ReplaceService Siehe ersetzt die _Wrapping Anbieter_ weiter oben</span><span class="sxs-lookup"><span data-stu-id="ee56b-262">The service can be wrapped or replaced using ReplaceService as described in the _Wrapping providers_ section above</span></span>
*   <span data-ttu-id="ee56b-263">Theoretisch könnte eine DbProviderServices-Implementierung eine "DbProviderFactory" aufgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-263">Theoretically, a DbProviderServices implementation could resolve a DbProviderFactory.</span></span>

<span data-ttu-id="ee56b-264">Wichtig zu beachten, die über eine der folgenden Aufgaben ausführen, ist, dass sie nur die Suche nach "DbProviderFactory" von EF auswirkt.</span><span class="sxs-lookup"><span data-stu-id="ee56b-264">The important point to note about doing any of these things is that they will only affect the lookup of DbProviderFactory by EF.</span></span> <span data-ttu-id="ee56b-265">Andere nicht EF-Code möglicherweise dennoch erwarten, dass der ADO NET-Anbieter auf die übliche Weise registriert werden und kann fehlschlagen, wenn die Registrierung nicht gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="ee56b-265">Other non-EF code may still expect the ADO.NET provider to be registered in the normal way and may fail if the registration is not found.</span></span> <span data-ttu-id="ee56b-266">Aus diesem Grund ist es normalerweise besser, für die einer "DbProviderFactory" wie gewohnt ADO.NET registriert werden.</span><span class="sxs-lookup"><span data-stu-id="ee56b-266">For this reason it is normally better for a DbProviderFactory to be registered in the normal ADO.NET way.</span></span>

### <a name="related-services"></a><span data-ttu-id="ee56b-267">Verwandte Dienste</span><span class="sxs-lookup"><span data-stu-id="ee56b-267">Related services</span></span>

<span data-ttu-id="ee56b-268">Wenn EF zum Auflösen einer "DbProviderFactory" verwendet wird, sollten auch die IProviderInvariantName und IDbProviderFactoryResolver-Dienste auflösen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-268">If EF is used to resolve a DbProviderFactory, then it should also resolve the IProviderInvariantName and IDbProviderFactoryResolver services.</span></span>

<span data-ttu-id="ee56b-269">IProviderInvariantName ist ein Dienst, der verwendet wird, um zu bestimmen, einen invarianten Anbieternamen für einen bestimmten Typ ' DbProviderFactory '.</span><span class="sxs-lookup"><span data-stu-id="ee56b-269">IProviderInvariantName is a service that is used to determine a provider invariant name for a given type of DbProviderFactory.</span></span> <span data-ttu-id="ee56b-270">Die standardmäßige Implementierung dieses Diensts wird die Registrierung des Anbieters ADO.NET verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-270">The default implementation of this service uses the ADO.NET provider registration.</span></span> <span data-ttu-id="ee56b-271">Dies bedeutet, dass wenn der ADO NET-Anbieter nicht auf die übliche Weise registriert ist, da der "DbProviderFactory" von EF aufgelöst wird, klicken Sie dann es außerdem erforderlich, um diesen Dienst zu beheben kann.</span><span class="sxs-lookup"><span data-stu-id="ee56b-271">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span> <span data-ttu-id="ee56b-272">Beachten Sie, dass ein Konfliktlöser für diesen Dienst automatisch hinzugefügt wird, wenn die DbConfiguration.SetProviderFactory-Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-272">Note that a resolver for this service is automatically added when using the DbConfiguration.SetProviderFactory method.</span></span>

<span data-ttu-id="ee56b-273">Siehe die _Anbieter Typen – Übersicht_ Abschnitt, der IDbProviderFactoryResolver verwendet, um die richtige "DbProviderFactory" aus einem angegebenen DbConnection-Objekt abzurufen.</span><span class="sxs-lookup"><span data-stu-id="ee56b-273">As described in the _Provider types overview_ section above, the IDbProviderFactoryResolver is used to obtain the correct DbProviderFactory from a given DbConnection object.</span></span> <span data-ttu-id="ee56b-274">Die standardmäßige Implementierung des Diensts bei der Ausführung von .NET 4 wird die Registrierung des Anbieters ADO.NET verwendet.</span><span class="sxs-lookup"><span data-stu-id="ee56b-274">The default implementation of this service when running on .NET 4 uses the ADO.NET provider registration.</span></span> <span data-ttu-id="ee56b-275">Dies bedeutet, dass wenn der ADO NET-Anbieter nicht auf die übliche Weise registriert ist, da der "DbProviderFactory" von EF aufgelöst wird, klicken Sie dann es außerdem erforderlich, um diesen Dienst zu beheben kann.</span><span class="sxs-lookup"><span data-stu-id="ee56b-275">This means that if the ADO.NET provider is not registered in the normal way because DbProviderFactory is being resolved by EF, then it will also be necessary to resolve this service.</span></span>
