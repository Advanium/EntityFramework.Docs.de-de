---
title: Aktualisieren von früheren Versionen auf EF Core 2 - Core EF
author: divega
ms.author: divega
ms.date: 8/13/2017
ms.assetid: 8BD43C8C-63D9-4F3A-B954-7BC518A1B7DB
ms.technology: entity-framework-core
uid: core/miscellaneous/1x-2x-upgrade
ms.openlocfilehash: 30f4de794d42b1385145286e77c2e7c67987fea6
ms.sourcegitcommit: b2d94cebdc32edad4fecb07e53fece66437d1b04
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/28/2018
ms.locfileid: "29678613"
---
# <a name="upgrading-applications-from-previous-versions-to-ef-core-20"></a><span data-ttu-id="a9b48-102">Aktualisieren von Anwendungen aus früheren Versionen von EF Core 2.0</span><span class="sxs-lookup"><span data-stu-id="a9b48-102">Upgrading applications from previous versions to EF Core 2.0</span></span>

## <a name="procedures-common-to-all-applications"></a><span data-ttu-id="a9b48-103">Prozeduren, die allen Anwendungen gemeinsam sind</span><span class="sxs-lookup"><span data-stu-id="a9b48-103">Procedures Common to All Applications</span></span>

<span data-ttu-id="a9b48-104">Aktualisieren einer vorhandenen Anwendung zu EF Core 2.0 erfordern:</span><span class="sxs-lookup"><span data-stu-id="a9b48-104">Updating an existing application to EF Core 2.0 may require:</span></span>

1. <span data-ttu-id="a9b48-105">Aktualisieren die Zielplattform .NET von der Anwendung in eine Anwendung ein, die .NET Standard 2.0 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-105">Upgrading the target .NET platform of the application to one that supports .NET Standard 2.0.</span></span> <span data-ttu-id="a9b48-106">Finden Sie unter [unterstützte Plattformen](../platforms/index.md) Weitere Details.</span><span class="sxs-lookup"><span data-stu-id="a9b48-106">See [Supported Platforms](../platforms/index.md) for more details.</span></span>

2. <span data-ttu-id="a9b48-107">Identifizieren Sie einen Anbieter für die Zieldatenbank mit EF Core 2.0 kompatibel sind.</span><span class="sxs-lookup"><span data-stu-id="a9b48-107">Identify a provider for the target database which is compatible with EF Core 2.0.</span></span> <span data-ttu-id="a9b48-108">Finden Sie unter [EF Core 2.0 erfordert einen 2.0 Datenbankanbieter](#ef-core-20-requires-a-20-database-provider) unten.</span><span class="sxs-lookup"><span data-stu-id="a9b48-108">See [EF Core 2.0 requires a 2.0 database provider](#ef-core-20-requires-a-20-database-provider) below.</span></span>

3. <span data-ttu-id="a9b48-109">Aktualisieren alle EF-Core-Pakete (Common Language Runtime und die Tools sind) auf 2.0.</span><span class="sxs-lookup"><span data-stu-id="a9b48-109">Upgrading all the EF Core packages (runtime and tooling) to 2.0.</span></span> <span data-ttu-id="a9b48-110">Finden Sie unter [installieren EF Core](../get-started/install/index.md) Weitere Details.</span><span class="sxs-lookup"><span data-stu-id="a9b48-110">Refer to [Installing EF Core](../get-started/install/index.md) for more details.</span></span>

4. <span data-ttu-id="a9b48-111">Nehmen Sie Änderungen erforderlichen Code, für die aktuelle Änderungen zu kompensieren.</span><span class="sxs-lookup"><span data-stu-id="a9b48-111">Make any necessary code changes to compensate for breaking changes.</span></span> <span data-ttu-id="a9b48-112">Finden Sie unter der [Breaking Changes](#breaking-changes) weiter unten für weitere Details.</span><span class="sxs-lookup"><span data-stu-id="a9b48-112">See the [Breaking Changes](#breaking-changes) section below for more details.</span></span>

## <a name="aspnet-core-applications"></a><span data-ttu-id="a9b48-113">ASP.NET Core-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="a9b48-113">ASP.NET Core applications</span></span>

1. <span data-ttu-id="a9b48-114">Insbesondere finden Sie in der [neues Muster für die Initialisierung der Anwendung Dienstanbieter](#new-way-of-getting-application-services) unten beschriebenen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-114">See in particular the [new pattern for initializing the application's service provider](#new-way-of-getting-application-services) described below.</span></span>

> [!TIP]  
> <span data-ttu-id="a9b48-115">Die Übernahme von diesem neuen Muster beim Aktualisieren von Anwendungen auf 2.0 wird dringend empfohlen, und ist erforderlich, damit für Produktfeatures wie Entity Framework Core Migrationen funktioniert.</span><span class="sxs-lookup"><span data-stu-id="a9b48-115">The adoption of this new pattern when updating applications to 2.0 is highly recommended and is required in order for product features like Entity Framework Core Migrations to work.</span></span> <span data-ttu-id="a9b48-116">Die allgemeine andere Alternative besteht darin, [implementieren *IDesignTimeDbContextFactory\<TContext >*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span><span class="sxs-lookup"><span data-stu-id="a9b48-116">The other common alternative is to [implement *IDesignTimeDbContextFactory\<TContext>*](xref:core/miscellaneous/cli/dbcontext-creation#from-a-design-time-factory).</span></span>

2. <span data-ttu-id="a9b48-117">Anwendungen, deren Zielversionen für ASP.NET Core 2.0 festgelegt sind, können neben Datenbankanbietern von Drittanbietern EF Core 2.0 ohne zusätzliche Abhängigkeiten nutzen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-117">Applications targeting ASP.NET Core 2.0 can use EF Core 2.0 without additional dependencies besides third party database providers.</span></span> <span data-ttu-id="a9b48-118">Allerdings müssen Anwendungen, die für frühere Versionen von ASP.NET Core zu ASP.NET Core 2.0 aktualisieren, um EF Core 2.0 zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-118">However, applications targeting previous versions of ASP.NET Core need to upgrade to ASP.NET Core 2.0 in order to use EF Core 2.0.</span></span> <span data-ttu-id="a9b48-119">Weitere Informationen zum Aktualisieren von ASP.NET Core Anwendungen 2.0 finden Sie unter [der ASP.NET Core-Dokumentation auf der das Subjekt](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span><span class="sxs-lookup"><span data-stu-id="a9b48-119">For more details on upgrading ASP.NET Core applications to 2.0 see [the ASP.NET Core documentation on the subject](https://docs.microsoft.com/aspnet/core/migration/1x-to-2x/).</span></span>

## <a name="breaking-changes"></a><span data-ttu-id="a9b48-120">Die Lauffähigkeit der Anwendung beeinträchtigende Änderungen</span><span class="sxs-lookup"><span data-stu-id="a9b48-120">Breaking Changes</span></span>

<span data-ttu-id="a9b48-121">Wir haben die Möglichkeit, unsere vorhandener APIs und Verhaltensweisen in 2.0 erheblich optimieren ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-121">We have taken the opportunity to significantly refine our existing APIs and behaviors in 2.0.</span></span> <span data-ttu-id="a9b48-122">Es sind einige Verbesserungen, die erforderlich sein können, Ändern vorhandener Anwendungscode, obwohl wir, die für die meisten Anwendungen in der Meinung sind die Auswirkungen niedrig ist, in den meisten Fällen erfordern nur Neukompilierung und nur minimale kommentierte Änderungen an veraltete APIs zu ersetzen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-122">There are a few improvements that can require modifying existing application code, although we believe that for the majority of applications the impact will be low, in most cases requiring just recompilation and minimal guided changes to replace obsolete APIs.</span></span>

### <a name="new-way-of-getting-application-services"></a><span data-ttu-id="a9b48-123">Neue Weise gelöschte Anwendungsdienste</span><span class="sxs-lookup"><span data-stu-id="a9b48-123">New way of getting application services</span></span>

<span data-ttu-id="a9b48-124">Das empfohlene Muster für ASP.NET Core Webanwendungen wurde für 2.0 auf eine Weise aktualisiert, die die Logik zur Entwurfszeit unterbrochen wurde, die EF Core 1.x verwendet.</span><span class="sxs-lookup"><span data-stu-id="a9b48-124">The recommended pattern for ASP.NET Core web applications has been updated for 2.0 in a way that broke the design-time logic EF Core used in 1.x.</span></span> <span data-ttu-id="a9b48-125">Zuvor zur Entwurfszeit, EF Core versuchen Sie, den aufzurufenden `Startup.ConfigureServices` direkt, um die Anwendung Dienstanbieter zugreifen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-125">Previously at design-time, EF Core would try to invoke `Startup.ConfigureServices` directly in order to access the application's service provider.</span></span> <span data-ttu-id="a9b48-126">In ASP.NET Core 2.0, wird die Konfiguration außerhalb von initialisiert die `Startup` Klasse.</span><span class="sxs-lookup"><span data-stu-id="a9b48-126">In ASP.NET Core 2.0, Configuration is initialized outside of the `Startup` class.</span></span> <span data-ttu-id="a9b48-127">Anwendungen, die in der Regel mithilfe von EF Core zugreifen ihre Verbindungszeichenfolge aus der Konfiguration, `Startup` allein reicht nicht mehr.</span><span class="sxs-lookup"><span data-stu-id="a9b48-127">Applications using EF Core typically access their connection string from Configuration, so `Startup` by itself is no longer sufficient.</span></span> <span data-ttu-id="a9b48-128">Wenn Sie eine ASP.NET Core 1.x-Anwendung aktualisieren, können Sie die folgende Fehlermeldung beim EF-Core-Tools verwenden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-128">If you upgrade an ASP.NET Core 1.x application, you may receive the following error when using the EF Core tools.</span></span>

> <span data-ttu-id="a9b48-129">Auf 'ApplicationContext' wurde kein parameterloser Konstruktor gefunden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-129">No parameterless constructor was found on 'ApplicationContext'.</span></span> <span data-ttu-id="a9b48-130">Fügen Sie einen parameterlosen Konstruktor 'ApplicationContext' oder Hinzufügen einer Implementierung von "IDesignTimeDbContextFactory&lt;ApplicationContext&gt;" in der gleichen Assembly als "ApplicationContext"</span><span class="sxs-lookup"><span data-stu-id="a9b48-130">Either add a parameterless constructor to 'ApplicationContext' or add an implementation of 'IDesignTimeDbContextFactory&lt;ApplicationContext&gt;' in the same assembly as 'ApplicationContext'</span></span>

<span data-ttu-id="a9b48-131">Ein neuer zur Entwurfszeit Hook wurde in ASP.NET Core 2.0-Standardvorlage hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-131">A new design-time hook has been added in ASP.NET Core 2.0's default template.</span></span> <span data-ttu-id="a9b48-132">Die statische `Program.BuildWebHost` Methode ermöglicht EF-Kerne und Zugriff auf den Dienstanbieter für die Anwendung zur Entwurfszeit.</span><span class="sxs-lookup"><span data-stu-id="a9b48-132">The static `Program.BuildWebHost` method enables EF Core to access the application's service provider at design time.</span></span> <span data-ttu-id="a9b48-133">Wenn Sie eine ASP.NET Core 1.x-Anwendung aktualisieren, müssen Sie Sie aktualisieren `Program` Klasse, um wie folgt aussehen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-133">If you are upgrading an ASP.NET Core 1.x application, you will need to update you `Program` class to resemble the following.</span></span>

``` csharp
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;

namespace AspNetCoreDotNetCore2._0App
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =>
            WebHost.CreateDefaultBuilder(args)
                .UseStartup<Startup>()
                .Build();
    }
}
```

### <a name="idbcontextfactory-renamed"></a><span data-ttu-id="a9b48-134">IDbContextFactory umbenannt</span><span class="sxs-lookup"><span data-stu-id="a9b48-134">IDbContextFactory renamed</span></span>

<span data-ttu-id="a9b48-135">Um die verschiedenen Anwendungsmuster unterstützen und Benutzern besser steuern, wie ihre `DbContext` dient zur Entwurfszeit, wir haben, in der Vergangenheit bereitgestellten die `IDbContextFactory<TContext>` Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="a9b48-135">In order to support diverse application patterns and give users more control over how their `DbContext` is used at design time, we have, in the past, provided the `IDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="a9b48-136">Zur Entwurfszeit verwendet wird, die EF Core Tools Implementierungen dieser Schnittstelle in Ihrem Projekt zu ermitteln, und verwenden sie zum Erstellen `DbContext` Objekte.</span><span class="sxs-lookup"><span data-stu-id="a9b48-136">At design-time, the EF Core tools will discover implementations of this interface in your project and use it to create `DbContext` objects.</span></span>

<span data-ttu-id="a9b48-137">Diese Schnittstelle hat einen sehr allgemeinen Name, die einige Benutzer versuchen, verwenden es erneut für andere irreführen `DbContext`-Szenarien zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-137">This interface had a very general name which mislead some users to try re-using it for other `DbContext`-creating scenarios.</span></span> <span data-ttu-id="a9b48-138">Sie deaktivieren Guard abgefangen wird, wenn die Tools EF versucht hat, verwenden Sie ihre Implementierung zur Entwurfszeit und Befehle wie verursacht wurden `Update-Database` oder `dotnet ef database update` fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-138">They were caught off guard when the EF Tools then tried to use their implementation at design-time and caused commands like `Update-Database` or `dotnet ef database update` to fail.</span></span>

<span data-ttu-id="a9b48-139">Um die starke zur Entwurfszeit Semantik dieser Schnittstelle kommunizieren zu können, haben wir es umbenannt `IDesignTimeDbContextFactory<TContext>`.</span><span class="sxs-lookup"><span data-stu-id="a9b48-139">In order to communicate the strong design-time semantics of this interface, we have renamed it to `IDesignTimeDbContextFactory<TContext>`.</span></span>

<span data-ttu-id="a9b48-140">Version 2.0 der `IDbContextFactory<TContext>` noch vorhanden ist, jedoch wird als veraltet markiert.</span><span class="sxs-lookup"><span data-stu-id="a9b48-140">For the 2.0 release the `IDbContextFactory<TContext>` still exists but is marked as obsolete.</span></span>

### <a name="dbcontextfactoryoptions-removed"></a><span data-ttu-id="a9b48-141">DbContextFactoryOptions entfernt</span><span class="sxs-lookup"><span data-stu-id="a9b48-141">DbContextFactoryOptions removed</span></span>

<span data-ttu-id="a9b48-142">Aufgrund der oben beschriebenen Änderungen ASP.NET Core 2.0 wurde ermittelt, die `DbContextFactoryOptions` wurde nicht mehr benötigt, auf dem neuen `IDesignTimeDbContextFactory<TContext>` Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="a9b48-142">Because of the ASP.NET Core 2.0 changes described above, we found that `DbContextFactoryOptions` was no longer needed on the new `IDesignTimeDbContextFactory<TContext>` interface.</span></span> <span data-ttu-id="a9b48-143">Hier sind die alternativen, die Sie stattdessen verwendet werden sollte.</span><span class="sxs-lookup"><span data-stu-id="a9b48-143">Here are the alternatives you should be using instead.</span></span>

| <span data-ttu-id="a9b48-144">DbContextFactoryOptions</span><span class="sxs-lookup"><span data-stu-id="a9b48-144">DbContextFactoryOptions</span></span> | <span data-ttu-id="a9b48-145">Alternative</span><span class="sxs-lookup"><span data-stu-id="a9b48-145">Alternative</span></span>                                                  |
|:------------------------|:-------------------------------------------------------------|
| <span data-ttu-id="a9b48-146">ApplicationBasePath</span><span class="sxs-lookup"><span data-stu-id="a9b48-146">ApplicationBasePath</span></span>     | <span data-ttu-id="a9b48-147">AppContext.BaseDirectory</span><span class="sxs-lookup"><span data-stu-id="a9b48-147">AppContext.BaseDirectory</span></span>                                     |
| <span data-ttu-id="a9b48-148">ContentRootPath</span><span class="sxs-lookup"><span data-stu-id="a9b48-148">ContentRootPath</span></span>         | <span data-ttu-id="a9b48-149">Directory.GetCurrentDirectory()</span><span class="sxs-lookup"><span data-stu-id="a9b48-149">Directory.GetCurrentDirectory()</span></span>                              |
| <span data-ttu-id="a9b48-150">EnvironmentName</span><span class="sxs-lookup"><span data-stu-id="a9b48-150">EnvironmentName</span></span>         | <span data-ttu-id="a9b48-151">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span><span class="sxs-lookup"><span data-stu-id="a9b48-151">Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT")</span></span> |

### <a name="design-time-working-directory-changed"></a><span data-ttu-id="a9b48-152">Während der Entwurfszeit-Arbeitsverzeichnis geändert</span><span class="sxs-lookup"><span data-stu-id="a9b48-152">Design-time working directory changed</span></span>

<span data-ttu-id="a9b48-153">Die ASP.NET Core 2.0-Änderungen muss auch von verwendeten Arbeitsverzeichnisses `dotnet ef` veröffentlichungshäufigkeit das Arbeitsverzeichnis, von Visual Studio verwendet werden, wenn die Anwendung ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-153">The ASP.NET Core 2.0 changes also required the working directory used by `dotnet ef` to align with the working directory used by Visual Studio when running your application.</span></span> <span data-ttu-id="a9b48-154">Eine Observable Nebeneffekt hiervon ist dieser SQLite Dateinamen wird jetzt relativ zum Projektverzeichnis und nicht in das Ausgabeverzeichnis sind, wie sie verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-154">One observable side effect of this is that SQLite filenames are now relative to the project directory and not the output directory like they used to be.</span></span>

### <a name="ef-core-20-requires-a-20-database-provider"></a><span data-ttu-id="a9b48-155">EF Core 2.0 erfordert einen 2.0-Datenbank-Anbieter</span><span class="sxs-lookup"><span data-stu-id="a9b48-155">EF Core 2.0 requires a 2.0 database provider</span></span>

<span data-ttu-id="a9b48-156">Für EF Core 2.0 haben wir viele vereinfachungen und Verbesserungen in die Datenbankanbieter Weise funktionieren.</span><span class="sxs-lookup"><span data-stu-id="a9b48-156">For EF Core 2.0 we have made many simplifications and improvements in the way database providers work.</span></span> <span data-ttu-id="a9b48-157">Dies bedeutet, dass der Anbieter 1.0.x und 1.1.x mit EF Core 2.0 nicht funktionieren.</span><span class="sxs-lookup"><span data-stu-id="a9b48-157">This means that 1.0.x and 1.1.x providers will not work with EF Core 2.0.</span></span>

<span data-ttu-id="a9b48-158">Die SQL Server- und SQLite-Anbieter werden vom Team EF ausgeliefert und 2.0-Versionen verfügbar als Teil der 2.0 freizugeben.</span><span class="sxs-lookup"><span data-stu-id="a9b48-158">The SQL Server and SQLite providers are shipped by the EF team and 2.0 versions will be available as part of the 2.0 release.</span></span> <span data-ttu-id="a9b48-159">Die Open-Source-Drittanbieter-Anbieter für [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), und [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) für 2.0 aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-159">The open-source third party providers for [SQL Compact](https://github.com/ErikEJ/EntityFramework.SqlServerCompact), [PostgreSQL](https://github.com/npgsql/Npgsql.EntityFrameworkCore.PostgreSQL), and [MySQL](https://github.com/PomeloFoundation/Pomelo.EntityFrameworkCore.MySql) are being updated for 2.0.</span></span> <span data-ttu-id="a9b48-160">Wenden Sie sich an den Anbieterwriter, um alle anderen Anbieter zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="a9b48-160">For all other providers, please contact the provider writer.</span></span>

### <a name="logging-and-diagnostics-events-have-changed"></a><span data-ttu-id="a9b48-161">Protokollierung und-Diagnose Ereignisse wurden geändert.</span><span class="sxs-lookup"><span data-stu-id="a9b48-161">Logging and Diagnostics events have changed</span></span>

<span data-ttu-id="a9b48-162">Hinweis: diese Änderungen sollte nicht Großteil des Anwendungscodes beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-162">Note: these changes should not impact most application code.</span></span>

<span data-ttu-id="a9b48-163">Die Ereignis-IDs für Nachrichten an eine [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) 2.0 geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-163">The event IDs for messages sent to an [ILogger](https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Abstractions/ILogger.cs) have changed in 2.0.</span></span> <span data-ttu-id="a9b48-164">Die Ereignis-IDs sind nun für alle EF Core-Codes eindeutig.</span><span class="sxs-lookup"><span data-stu-id="a9b48-164">The event IDs are now unique across EF Core code.</span></span> <span data-ttu-id="a9b48-165">Diese Nachrichten entsprechen nun auch dem Standardmuster für die strukturierte Protokollierung, das z.B. von MVC eingesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="a9b48-165">These messages now also follow the standard pattern for structured logging used by, for example, MVC.</span></span>

<span data-ttu-id="a9b48-166">Die Protokollierungskategorien haben sich ebenfalls geändert.</span><span class="sxs-lookup"><span data-stu-id="a9b48-166">Logger categories have also changed.</span></span> <span data-ttu-id="a9b48-167">Nun gibt es eine bekannte Gruppe von Kategorien, auf die über [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs) zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="a9b48-167">There is now a well-known set of categories accessed through [DbLoggerCategory](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/DbLoggerCategory.cs).</span></span>

<span data-ttu-id="a9b48-168">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) Ereignisse verwenden nun die gleichnamigen der Ereignis-ID als die entsprechenden `ILogger` Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="a9b48-168">[DiagnosticSource](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/DiagnosticSourceUsersGuide.md) events now use the same event ID names as the corresponding `ILogger` messages.</span></span> <span data-ttu-id="a9b48-169">Die ereignisnutzlasten sind alle Nominale Typen abgeleitet [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span><span class="sxs-lookup"><span data-stu-id="a9b48-169">The event payloads are all nominal types derived from [EventData](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/EventData.cs).</span></span>

<span data-ttu-id="a9b48-170">Ereignis-IDs, Nutzlasttypen und Kategorien sind dokumentiert die [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) und [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) Klassen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-170">Event IDs, payload types, and categories are documented in the [CoreEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Diagnostics/CoreEventId.cs) and the [RelationalEventId](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore.Relational/Diagnostics/RelationalEventId.cs) classes.</span></span>

<span data-ttu-id="a9b48-171">IDs verfügen auch vom Microsoft.EntityFrameworkCore.Infraestructure auf dem neuen Microsoft.EntityFrameworkCore.Diagnostics-Namespace verschoben.</span><span class="sxs-lookup"><span data-stu-id="a9b48-171">IDs have also moved from Microsoft.EntityFrameworkCore.Infraestructure to the new Microsoft.EntityFrameworkCore.Diagnostics namespace.</span></span>

### <a name="ef-core-relational-metadata-api-changes"></a><span data-ttu-id="a9b48-172">EF Core relationalen Metadaten-API-Änderungen</span><span class="sxs-lookup"><span data-stu-id="a9b48-172">EF Core relational metadata API changes</span></span>

<span data-ttu-id="a9b48-173">EF Core 2.0 erstellt nun eine andere [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs)-Klasse für die verschiedenen verwendeten Anbieter.</span><span class="sxs-lookup"><span data-stu-id="a9b48-173">EF Core 2.0 will now build a different [IModel](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IModel.cs) for each different provider being used.</span></span> <span data-ttu-id="a9b48-174">Dies geschieht in der Regel auf eine für die Anwendung transparente Weise.</span><span class="sxs-lookup"><span data-stu-id="a9b48-174">This is usually transparent to the application.</span></span> <span data-ttu-id="a9b48-175">Dies hat eine Vereinfachung der untergeordneten Metadaten-APIs ermöglicht, sodass Zugriffe auf _gemeinsame relationale Metadatenkonzepte_ immer durch Aufrufen von `.Relational` statt `.SqlServer`, `.Sqlite` usw. erfolgen. Z. B. 1.1.x Code wie folgt:</span><span class="sxs-lookup"><span data-stu-id="a9b48-175">This has facilitated a simplification of lower-level metadata APIs such that any access to _common relational metadata concepts_ is always made through a call to `.Relational` instead of `.SqlServer`, `.Sqlite`, etc. For example, 1.1.x code like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).SqlServer().TableName;
```

<span data-ttu-id="a9b48-176">Sollte jetzt wie folgt geschrieben werden:</span><span class="sxs-lookup"><span data-stu-id="a9b48-176">Should now be written like this:</span></span>

``` csharp
var tableName = context.Model.FindEntityType(typeof(User)).Relational().TableName;
```

<span data-ttu-id="a9b48-177">Statt Methoden wie z. B. `ForSqlServerToTable`, Erweiterungsmethoden stehen jetzt zur bedingten basierend auf den aktuellen Anbieter verwendet Code zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="a9b48-177">Instead of using methods like `ForSqlServerToTable`, extension methods are now available to write conditional code based on the current provider in use.</span></span> <span data-ttu-id="a9b48-178">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="a9b48-178">For example:</span></span>

```C#
modelBuilder.Entity<User>().ToTable(
    Database.IsSqlServer() ? "SqlServerName" : "OtherName");
```

<span data-ttu-id="a9b48-179">Beachten Sie, die diese Änderung gilt nur für APIs-Metadaten, die für definiert ist _alle_ relationalen Anbieter.</span><span class="sxs-lookup"><span data-stu-id="a9b48-179">Note that this change only applies to APIs/metadata that is defined for _all_ relational providers.</span></span> <span data-ttu-id="a9b48-180">Die API und die Metadaten bleibt unverändert, wenn es nur einen einzelnen Anbieter spezifisch ist.</span><span class="sxs-lookup"><span data-stu-id="a9b48-180">The API and metadata remains the same when it is specific to only a single provider.</span></span> <span data-ttu-id="a9b48-181">Gruppierte Indizes sind z. B. spezifisch für SQL Server, damit `ForSqlServerIsClustered` und `.SqlServer().IsClustered()` müssen immer noch verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-181">For example, clustered indexes are specific to SQL Sever, so `ForSqlServerIsClustered` and  `.SqlServer().IsClustered()` must still be used.</span></span>

### <a name="dont-take-control-of-the-ef-service-provider"></a><span data-ttu-id="a9b48-182">Keine Kontrolle des Dienstanbieters EF</span><span class="sxs-lookup"><span data-stu-id="a9b48-182">Don’t take control of the EF service provider</span></span>

<span data-ttu-id="a9b48-183">EF Kern verwendet eine interne `IServiceProvider` (d. h. einen abhängigkeitseinschleusungscontainer) für die interne Implementierung.</span><span class="sxs-lookup"><span data-stu-id="a9b48-183">EF Core uses an internal `IServiceProvider` (i.e. a dependency injection container) for its internal implementation.</span></span> <span data-ttu-id="a9b48-184">Anwendungen sollten EF Kern zu erstellen und Verwalten von diesem Anbieter außer in besonderen Fällen zulassen.</span><span class="sxs-lookup"><span data-stu-id="a9b48-184">Applications should allow EF Core to create and manage this provider except in special cases.</span></span> <span data-ttu-id="a9b48-185">Sollten Sie dringend, entfernen alle Aufrufe von `UseInternalServiceProvider`.</span><span class="sxs-lookup"><span data-stu-id="a9b48-185">Strongly consider removing any calls to `UseInternalServiceProvider`.</span></span> <span data-ttu-id="a9b48-186">Wenn eine Anwendung aufrufen muss `UseInternalServiceProvider`, dann erwägen Sie [Ablegen eines Problems](https://github.com/aspnet/EntityFramework/Issues) damit wir Möglichkeiten für Ihr Szenario zu behandeln, untersuchen können.</span><span class="sxs-lookup"><span data-stu-id="a9b48-186">If an application does need to call `UseInternalServiceProvider`, then please consider [filing an issue](https://github.com/aspnet/EntityFramework/Issues) so we can investigate other ways to handle your scenario.</span></span>

<span data-ttu-id="a9b48-187">Aufrufen von `AddEntityFramework`, `AddEntityFrameworkSqlServer`, usw. ist nicht vom Anwendungscode erforderlich, es sei denn, `UseInternalServiceProvider` wird auch als bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="a9b48-187">Calling `AddEntityFramework`, `AddEntityFrameworkSqlServer`, etc. is not required by application code unless `UseInternalServiceProvider` is also called.</span></span> <span data-ttu-id="a9b48-188">Entfernen Sie alle vorhandenen Aufrufe `AddEntityFramework` oder `AddEntityFrameworkSqlServer`usw. `AddDbContext` sollte weiterhin verwendet werden auf die gleiche Weise wie zuvor.</span><span class="sxs-lookup"><span data-stu-id="a9b48-188">Remove any existing calls to `AddEntityFramework` or `AddEntityFrameworkSqlServer`, etc. `AddDbContext` should still be used in the same way as before.</span></span>

### <a name="in-memory-databases-must-be-named"></a><span data-ttu-id="a9b48-189">In-Memory-Datenbanken müssen benannt sein</span><span class="sxs-lookup"><span data-stu-id="a9b48-189">In-memory databases must be named</span></span>

<span data-ttu-id="a9b48-190">Die globalen unbenannte in-Memory-Datenbank wurde entfernt und stattdessen alle in-Memory-Datenbanken müssen benannt sein kann.</span><span class="sxs-lookup"><span data-stu-id="a9b48-190">The global unnamed in-memory database has been removed and instead all in-memory databases must be named.</span></span> <span data-ttu-id="a9b48-191">Zum Beispiel:</span><span class="sxs-lookup"><span data-stu-id="a9b48-191">For example:</span></span>

``` csharp
optionsBuilder.UseInMemoryDatabase("MyDatabase");
```

<span data-ttu-id="a9b48-192">Dies erstellt/wird eine Datenbank mit dem Namen "MyDatabase" verwendet.</span><span class="sxs-lookup"><span data-stu-id="a9b48-192">This creates/uses a database with the name “MyDatabase”.</span></span> <span data-ttu-id="a9b48-193">Wenn `UseInMemoryDatabase` erneut aufgerufen, mit dem gleichen Namen wird die gleiche in-Memory-Datenbank ermöglicht, die von mehreren Kontext Instanzen gemeinsam genutzt werden verwendet,.</span><span class="sxs-lookup"><span data-stu-id="a9b48-193">If `UseInMemoryDatabase` is called again with the same name, then the same in-memory database will be used, allowing it to be shared by multiple context instances.</span></span>

### <a name="read-only-api-changes"></a><span data-ttu-id="a9b48-194">Nur-Lese API-Änderungen</span><span class="sxs-lookup"><span data-stu-id="a9b48-194">Read-only API changes</span></span>

<span data-ttu-id="a9b48-195">`IsReadOnlyBeforeSave`, `IsReadOnlyAferSave`, und `IsStoreGeneratedAlways` akkumuliert und mit ersetzt wurden [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) und [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span><span class="sxs-lookup"><span data-stu-id="a9b48-195">`IsReadOnlyBeforeSave`, `IsReadOnlyAferSave`, and `IsStoreGeneratedAlways` have been obsoleted and replaced with [BeforeSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L39) and [AfterSaveBehavior](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/IProperty.cs#L55).</span></span> <span data-ttu-id="a9b48-196">Dieses Verhalten gelten für jede Eigenschaft (nicht nur vom Speicher generierte Eigenschaften) und zu bestimmen, wie der Wert der Eigenschaft verwendet werden soll, beim Einfügen in eine Datenbankzeile (`BeforeSaveBehavior`) oder beim Aktualisieren einer vorhandenen Zeile (`AfterSaveBehavior`).</span><span class="sxs-lookup"><span data-stu-id="a9b48-196">These behaviors apply to any property (not only store-generated properties) and determine how the value of the property should be used when inserting into a database row (`BeforeSaveBehavior`) or when updating an existing database row (`AfterSaveBehavior`).</span></span>

<span data-ttu-id="a9b48-197">Eigenschaften, die als gekennzeichnet [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (z. B. für berechnete Spalten) standardmäßig ignoriert ausnahmslos derzeit für die Eigenschaft festgelegt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-197">Properties marked as [ValueGenerated.OnAddOrUpdate](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/ValueGenerated.cs) (e.g. for computed columns) will by default ignore any value currently set on the property.</span></span> <span data-ttu-id="a9b48-198">Dies bedeutet, dass ein vom Speicher generierter Wert immer abgerufen werden kann, unabhängig davon, ob ausnahmslos festgelegt oder für die nachverfolgte Entität geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="a9b48-198">This means that a store-generated value will always be obtained regardless of whether any value has been set or modified on the tracked entity.</span></span> <span data-ttu-id="a9b48-199">Dies kann geändert werden, durch Festlegen einer anderen `Before\AfterSaveBehavior`.</span><span class="sxs-lookup"><span data-stu-id="a9b48-199">This can be changed by setting a different `Before\AfterSaveBehavior`.</span></span>

### <a name="new-clientsetnull-delete-behavior"></a><span data-ttu-id="a9b48-200">Neue ClientSetNull löschverhaltens</span><span class="sxs-lookup"><span data-stu-id="a9b48-200">New ClientSetNull delete behavior</span></span>

<span data-ttu-id="a9b48-201">In früheren Versionen [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) hatte ein Verhalten für Entitäten vom Kontext verfolgt, dass mehrere übereinstimmende geschlossen `SetNull` Semantik.</span><span class="sxs-lookup"><span data-stu-id="a9b48-201">In previous releases, [DeleteBehavior.Restrict](https://github.com/aspnet/EntityFramework/blob/dev/src/EFCore/Metadata/DeleteBehavior.cs) had a behavior for entities tracked by the context that more closed matched `SetNull` semantics.</span></span> <span data-ttu-id="a9b48-202">In der EF Core 2.0 ein neues `ClientSetNull` Verhalten wurde als Standard für optionale Beziehungen eingeführt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-202">In EF Core 2.0, a new `ClientSetNull` behavior has been introduced as the default for optional relationships.</span></span> <span data-ttu-id="a9b48-203">Dieses Verhalten hat `SetNull` Semantik für überwachten Entitäten und `Restrict` Verhalten für Datenbanken mit EF Core erstellt.</span><span class="sxs-lookup"><span data-stu-id="a9b48-203">This behavior has `SetNull` semantics for tracked entities and `Restrict` behavior for databases created using EF Core.</span></span> <span data-ttu-id="a9b48-204">In unserer Erfahrung sind dies die erwartet/nützlichsten Verhaltensweisen für nachverfolgte Objekte und die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="a9b48-204">In our experience, these are the most expected/useful behaviors for tracked entities and the database.</span></span> <span data-ttu-id="a9b48-205">`DeleteBehavior.Restrict` wird jetzt für überwachten Entitäten, die bei der Einstellung für optionale Beziehungen berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="a9b48-205">`DeleteBehavior.Restrict` is now honored for tracked entities when set for optional relationships.</span></span>

### <a name="provider-design-time-packages-removed"></a><span data-ttu-id="a9b48-206">Anbieter während der Entwurfszeit Pakete entfernt</span><span class="sxs-lookup"><span data-stu-id="a9b48-206">Provider design-time packages removed</span></span>

<span data-ttu-id="a9b48-207">Die `Microsoft.EntityFrameworkCore.Relational.Design` Paket entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="a9b48-207">The `Microsoft.EntityFrameworkCore.Relational.Design` package has been removed.</span></span> <span data-ttu-id="a9b48-208">Der Inhalt konsolidiert wurden `Microsoft.EntityFrameworkCore.Relational` und `Microsoft.EntityFrameworkCore.Design`.</span><span class="sxs-lookup"><span data-stu-id="a9b48-208">It's contents were consolidated into `Microsoft.EntityFrameworkCore.Relational` and `Microsoft.EntityFrameworkCore.Design`.</span></span>

<span data-ttu-id="a9b48-209">Dies wird in der Anbieter während der Entwurfszeit Pakete weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="a9b48-209">This propagates into the provider design-time packages.</span></span> <span data-ttu-id="a9b48-210">Diese Pakete (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`usw.) entfernt wurden und deren Inhalt in die Haupt-Anbieters Pakete zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="a9b48-210">Those packages (`Microsoft.EntityFrameworkCore.Sqlite.Design`, `Microsoft.EntityFrameworkCore.SqlServer.Design`, etc.) were removed and their contents consolidated into the main provider packages.</span></span>

<span data-ttu-id="a9b48-211">So aktivieren Sie `Scaffold-DbContext` oder `dotnet ef dbcontext scaffold` in EF Core 2.0 müssen Sie nur das Paket für die einzelnen Anbieter zu verweisen:</span><span class="sxs-lookup"><span data-stu-id="a9b48-211">To enable `Scaffold-DbContext` or `dotnet ef dbcontext scaffold` in EF Core 2.0, you only need to reference the single provider package:</span></span>

``` xml
<PackageReference Include="Microsoft.EntityFrameworkCore.SqlServer"
    Version="2.0.0" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools"
    Version="2.0.0"
    PrivateAssets="All" />
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet"
    Version="2.0.0" />
```
